<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">

	<title>Phunware Messaging with Lua - SDKBOX</title>
        
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../../css/base.css?2" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">
        <link href="../../../css/custom.css" rel="stylesheet">
        

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="http://sdkbox.com"><img src="http://www.cocos2d-x.org/s/sdkbox/SDKBOX_logo.png">Docs</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">

            <ul class="nav navbar-nav navbar-right">


            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Overview</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cocos2d-x <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../cocos/">Overview</a>
</li>

                        
                            
<li >
    <a href="../../../installer/">CLI Installer</a>
</li>

                        
                            
<li >
    <a href="../../../qa/cocos_creator/">For Cocos Creator</a>
</li>

                        
                            
  
  <li class="dropdown-submenu">
    <a tabindex="-1" class="non-link">Plugins</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../achievement/">Achievements</a>
</li>

        
            
  

        
            
<li >
    <a href="../../adcolony/">AdColony</a>
</li>

        
            
  

        
            
<li >
    <a href="../../admob/">AdMob</a>
</li>

        
            
  

        
            
<li >
    <a href="../../agecheq/">AgeCheq</a>
</li>

        
            
  

        
            
<li >
    <a href="../../appnext/">Appnext</a>
</li>

        
            
  

        
            
<li >
    <a href="../../appodeal/">Appodeal</a>
</li>

        
            
  

        
            
<li >
    <a href="../../amazon/">Amazon</a>
</li>

        
            
  

        
            
<li >
    <a href="../../apteligent/">Apteligent</a>
</li>

        
            
  

        
            
<li >
    <a href="../../bee7/">Bee7</a>
</li>

        
            
  

        
            
<li >
    <a href="../../chartboost/">Chartboost</a>
</li>

        
            
  

        
            
<li >
    <a href="../../facebook/">Facebook</a>
</li>

        
            
  

        
            
<li >
    <a href="../../firebase/">Firebase</a>
</li>

        
            
  

        
            
<li >
    <a href="../../flurryanalytics/">Flurry Analytics</a>
</li>

        
            
  

        
            
<li >
    <a href="../../fyber/">Fyber</a>
</li>

        
            
  

        
            
<li >
    <a href="../../googleanalytics/">Google Analytics</a>
</li>

        
            
  

        
            
<li >
    <a href="../../googleplay/">Google Play Games</a>
</li>

        
            
  

        
            
<li >
    <a href="../../iap/">In-App Purchase</a>
</li>

        
            
  

        
            
<li >
    <a href="../../inmobi/">InMobi</a>
</li>

        
            
  

        
            
<li >
    <a href="../../kochava/">Kochava</a>
</li>

        
            
  

        
            
<li >
    <a href="../../leadbolt/">LeadBolt</a>
</li>

        
            
  

        
            
<li >
    <a href="../../leaderboard/">Leaderboard</a>
</li>

        
            
  

        
            
<li >
    <a href="../../onesignal/">OneSignal</a>
</li>

        
            
  

        
            
<li >
    <a href="../../playphone/">Playphone</a>
</li>

        
            
  

        
            
<li >
    <a href="../../phunwareads/">Phunware Ads</a>
</li>

        
            
  

        
            
<li >
    <a href="../">Phunware Messaging</a>
</li>

        
            
  

        
            
<li >
    <a href="../../review/">Ratings & Reviews</a>
</li>

        
            
  

        
            
<li >
    <a href="../../sdkboxads/">SDKBOX Ads</a>
</li>

        
            
  

        
            
<li >
    <a href="../../sdkboxplay/">SDKBOX Play</a>
</li>

        
            
  

        
            
<li >
    <a href="../../share/">Social Sharing</a>
</li>

        
            
  

        
            
<li >
    <a href="../../tune/">Tune</a>
</li>

        
            
  

        
            
<li >
    <a href="../../unityads/">UnityAds</a>
</li>

        
            
  

        
            
<li >
    <a href="../../valuepotion/">Valuepotion</a>
</li>

        
            
  

        
            
<li >
    <a href="../../vungle/">Vungle</a>
</li>

        
            
  

        
            
<li >
    <a href="../../youtube/">Youtube</a>
</li>

        
            
  

        
    </ul>
  </li>
  

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Unity <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../unity/allinone/">SDKBOX AllInOne</a>
</li>

                        
                            
<li >
    <a href="../../../unity/iap/">In-App Purchase</a>
</li>

                        
                            
<li >
    <a href="../../../unity/review/">Ratings & Reviews</a>
</li>

                        
                            
<li >
    <a href="../../../unity/socialshare/">SocialShare</a>
</li>

                        
                            
<li >
    <a href="../../../unity/googleanalytics/">Google Analytics</a>
</li>

                        
                            
<li >
    <a href="../../../unity/sdkboxplay/">SDKBOX Play</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Unreal <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../unreal/iap/">In-App Purchase</a>
</li>

                        
                            
<li >
    <a href="../../../unreal/chartboost/">Chartboost</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">LiveOps <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../liveops/">Setup</a>
</li>

                        
                            
<li >
    <a href="../../../liveops/remote-config/">Remote Configuration</a>
</li>

                        
                            
<li >
    <a href="../../../liveops/receipt-verification/">Server-side IAP receipt verification</a>
</li>

                        
                            
<li >
    <a href="../../../liveops/catalog-management/">On-the-fly catalog management</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../qa/integration-admob-to-creator/">Admob in Creator</a>
</li>

                        
                            
<li >
    <a href="../../../qa/integration-fyber-to-cocos/">Fyber with Cocos2d-x</a>
</li>

                        
                            
<li >
    <a href="../../../qa/fb-share-on-cocos/">Facebook with Cocos2d-x</a>
</li>

                        
                            
<li >
    <a href="../../../qa/android_64k/">Fix Android 64K methods limit</a>
</li>

                        
                            
<li >
    <a href="../../../qa/integration-iap-on-unity/">IAP with Unity</a>
</li>

                        
                            
<li >
    <a href="../../../qa/use-gui-integration-ga-to-creator/">GA with SDKBox GUI in Creator</a>
</li>

                        
                            
<li >
    <a href="../../../qa/use-custom-activity-on-unity/">Unity Custom Activity</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../../release-note/">About</a>
                    </li>
                
                

                <li style="margin-left:30px">
                    <a href="http://sdkbox-doc.github.io/zh/">中文</a>
                </li>
                
                </ul>
            




            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#integration">Integration</a></li>
	
    
        <li class="main "><a href="#configure-your-app-for-push-notifications-ios">Configure your app for push notifications (iOS)</a></li>
	
    
        <li class="main "><a href="#android-configuration">Android Configuration</a></li>
	
    
        <li class="main "><a href="#configure-your-app-for-push-notifications-android">Configure your app for push notifications (Android)</a></li>
	
    
        <li class="main "><a href="#important-notice">Important Notice</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#disable-app-transport-security">Disable App Transport Security</a></li>
        
            <li><a href="#disable-bitcode-support">Disable Bitcode support</a></li>
        
            <li><a href="#set-your-game-requires-full-screen">Set your game requires full screen</a></li>
        
            <li><a href="#whitelist-canopenurl-function">Whitelist canOpenURL function</a></li>
        
            <li><a href="#json-configuration">JSON Configuration</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#usage">Usage</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#initialize-phunwaremessaging">Initialize PhunwareMessaging</a></li>
        
            <li><a href="#read-message">Read message</a></li>
        
            <li><a href="#remove-message">Remove message</a></li>
        
            <li><a href="#get-all-messages">Get all messages</a></li>
        
            <li><a href="#catch-phunwaremessaging-events-optional">Catch PhunwareMessaging events (optional)</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#api-reference">API Reference</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#methods">Methods</a></li>
        
            <li><a href="#listeners">Listeners</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#manual-integration">Manual Integration</a></li>
	
    
        <li class="main "><a href="#manual-integration-for-ios">Manual Integration For iOS</a></li>
	
    
        <li class="main "><a href="#manual-integration-for-android">Manual Integration For Android</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#copy-files">Copy Files</a></li>
        
            <li><a href="#edit-androidmanifestxml">Edit AndroidManifest.xml</a></li>
        
            <li><a href="#edit-androidmk">Edit Android.mk</a></li>
        
            <li><a href="#modify-applicationmk-cocos2d-x-v30-to-v32-only">Modify Application.mk (Cocos2d-x v3.0 to v3.2 only)</a></li>
        
            <li><a href="#edit-androidmanifestxml_1">Edit AndroidManifest.xml</a></li>
        
            <li><a href="#edit-buildgradle">Edit build.gradle</a></li>
        
            <li><a href="#modify-cocos2dxactivityjava">Modify Cocos2dxActivity.java</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#proguard-optional">Proguard (optional)</a></li>
	
    
        <li class="main "><a href="#notice">Notice</a></li>
	
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p><a href="../">&#8249; PhunwareMessaging Doc Home</a></p>
<h1>Phunware Integration Guide（Messaging）</h1>

<h4><em><b>For the Lua version of cocos2d-x v3.x</b> - (<a href="./../">all other versions</a>)</em></h4>

<h2 id="integration">Integration</h2>
<p>Open a terminal and use the following command to install the SDKBOX <a href="http://maas.phunware.com/">Phunware Messaging</a> plugin. Make sure you setup the SDKBOX installer correctly.</p>
<pre><code class="bash">$ sdkbox import phunwaremessaging
</code></pre>

<h2 id="configure-your-app-for-push-notifications-ios">Configure your app for push notifications (iOS)</h2>
<ol>
<li>
<p>Go to <a href="https://developer.apple.com">Apple developer portal</a> and create a push notification certificate. (See <a href="https://www.raywenderlich.com/123862/push-notifications-tutorial">Push notification tutorial</a> for detailed instructions)</p>
</li>
<li>
<p>Once it's created, download the push production certificate and add it to Keychain Access. Then,
   from Keychain Access, export both the certificate and key. (Right click to view the Export option)
   as a .p12 and set a password.</p>
</li>
<li>
<p>Now, log on to the Maas Portal, navigate to the app created for your application and update the following.</p>
<ul>
<li>Certificate (.p12): Click the grey ellipses button to upload the Production Push Certificate
  you created on developer.apple.com.</li>
<li>Password: The password you setup for the push certificate.</li>
<li>Environment: Use Sandbox for debug builds. Use Production environment for production apps and Production Ad-Hoc build.</li>
</ul>
</li>
</ol>
<h2 id="android-configuration">Android Configuration</h2>
<ol>
<li>Phunware messaging currently only supports Android-Studio</li>
<li>Create a new Android application in MAAS-portal</li>
<li>In strings.xml (under Sample/src/main/res/values), replace the appId, accessKey and signatureKey with values for this application in MAAS portal.</li>
<li>Set up <a href="https://developers.google.com/cloud-messaging/android/client">Google Cloud Messaging</a></li>
<li>Create a project on Firebase console</li>
<li>Choose 'Add Firebase to Android app'</li>
<li>In the Firebase console, the package name should be the same as application id in build.grade (under Sample directory)</li>
<li>In the MAAS portal, for the newly created Android app, replace the API Key and sender id with the values for ServerKey and SenderId on the Firebase console (under CloudMessaging section)</li>
<li>The Firebase console creates a google-services.json file and downloads it to your default Downloads folder.</li>
<li>Replace the default google-service.json file (under Sample directory) the sample app with the dowloaded google-service.json from Firebase console</li>
<li>Add the google-services gradle plugin to you applications gradle file
  <code>apply plugin: 'com.google.gms.google-services'</code></li>
</ol>
<h2 id="configure-your-app-for-push-notifications-android">Configure your app for push notifications (Android)</h2>
<p><strong>NOTE</strong>: PhunwareMessaing don't support Eclipse/Ant project</p>
<ol>
<li>
<p>Set up GCM at https://developers.google.com/cloud-messaging/android/client</p>
</li>
<li>
<p>Create a project on Firebase console</p>
<ul>
<li>Choose 'Add Firebase to Android app'</li>
<li>In the Firebase console, the package name should be the same as application id in build.grade</li>
<li>The Firebase console creates a google-services.json file and downloads it to your default Downloads folder.</li>
<li>Put the google-services.json file to proj.android-studio/app/ folder</li>
</ul>
</li>
</ol>
<h2 id="important-notice">Important Notice</h2>
<p>Please make sure the following settings in your project for plugin to function correctly.</p>
<h4 id="disable-app-transport-security">Disable App Transport Security</h4>
<p>Adding the following entry to the <code>info.plist</code> file:</p>
<pre><code>&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;
&lt;dict&gt;
    &lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;
    &lt;true/&gt;
&lt;/dict&gt;
</code></pre>

<p>It should look something like this:</p>
<p><img alt="" src="../../../imgs/ATS.png" /></p>
<h4 id="disable-bitcode-support">Disable Bitcode support</h4>
<p>You have to turn off <strong>Bitcode</strong> support. If you don't cocos2d-x will fail to build.</p>
<h4 id="set-your-game-requires-full-screen">Set your game requires full screen</h4>
<p>If your game doesn't support all screen orientations you will need to check <code>Requires full screen</code> in Xcode. If you do not, your app will fail Apple's submission process.</p>
<h4 id="whitelist-canopenurl-function">Whitelist canOpenURL function</h4>
<p>This depends on what plugins are in your project. You may need to add the required entry to the <code>info.plist</code>, under <code>LSApplicationQueriesSchemes</code>.</p>
<!--## Configuration

## Remote Configuration

Optionally, you can choose to use SDKBOX LiveOps to remotely update this plugin's configuration. [Learn more](/liveops/remote-config)-->

<h3 id="json-configuration">JSON Configuration</h3>
<p>SDKBOX Installer will automatically inject a sample configuration to your <code>sdkbox_config.json</code>, that you have to modify it before you can use it for your own app.</p>
<p>Here is an example of the PhunwareMessaging configuration.</p>
<pre><code class="json">{
    &quot;ios&quot;: {
        &quot;PhunwareMessaging&quot;:{
            &quot;debug&quot;:true,
            &quot;api_id&quot;:&quot;1569&quot;,
            &quot;access_key&quot;:&quot;b49ea8dc7bdc4a056d51e8b72a8f3a575047a4aa&quot;,
            &quot;signature_key&quot;:&quot;b3f090e90cefe5b9535b0703d94a89a10f8a934b&quot;
        }
    },
    &quot;android&quot;: {
        &quot;PhunwareMessaging&quot;:{
            &quot;debug&quot;:true,
            &quot;api_id&quot;:&quot;1527&quot;,
            &quot;access_key&quot;:&quot;c11a65cb3deeca49aac6f8c0e794b7bc68e1481a&quot;,
            &quot;signature_key&quot;:&quot;1580b669f2edb1c810c29e52e9a754f443f6215a&quot;,
            &quot;env&quot;:&quot;dev&quot;
        }
    }
}
</code></pre>

<!---->

<h2 id="usage">Usage</h2>
<h3 id="initialize-phunwaremessaging">Initialize PhunwareMessaging</h3>
<ul>
<li>Modify your Lua code to <code>init()</code> the plugin. This can be done anyplace, however it must be done before trying to use the plugin's features.</li>
</ul>
<pre><code class="lua">sdkbox.PluginPhunwareMessaging:init()
</code></pre>

<h3 id="read-message">Read message</h3>
<pre><code class="lua">// To use customized location
sdkbox.PluginPhunwareMessaging:read(&quot;123&quot;)
</code></pre>

<h3 id="remove-message">Remove message</h3>
<pre><code class="lua">sdkbox.PluginPhunwareMessaging:remove(&quot;123&quot;)
</code></pre>

<h3 id="get-all-messages">Get all messages</h3>
<pre><code class="lua">sdkbox.PluginPhunwareMessaging:messages()
</code></pre>

<h3 id="catch-phunwaremessaging-events-optional">Catch PhunwareMessaging events (optional)</h3>
<p>This allows you to catch the <code>PhunwareMessaging</code> events so that you can perform operations such as providing player rewards for viewing ads.</p>
<ul>
<li>Create a listener (demonstrated by logging events):</li>
</ul>
<pre><code class="lua">sdkbox.PluginPhunwareMessaging:setListener(function(args)

    if &quot;init&quot; = args.event then
        print(args.event, args.success, args.message)
    elseif &quot;error&quot; = args.event then
        print(args.event, args.message)
    end

end)
</code></pre>

<h2 id="api-reference">API Reference</h2>
<h3 id="methods">Methods</h3>
<pre><code class="lua">sdkbox.PluginPhunwareMessaging:init()
</code></pre>

<blockquote>
<p>initialize the plugin instance.</p>
</blockquote>
<pre><code class="lua">sdkbox.PluginPhunwareMessaging:setListener(listener)
</code></pre>

<blockquote>
<p>Set listener to listen for phunwaremessaging events</p>
</blockquote>
<pre><code class="lua">sdkbox.PluginPhunwareMessaging:read(messageID)
</code></pre>

<pre><code class="lua">sdkbox.PluginPhunwareMessaging:remove(messageID)
</code></pre>

<pre><code class="lua">sdkbox.PluginPhunwareMessaging:deviceId()
</code></pre>

<pre><code class="lua">sdkbox.PluginPhunwareMessaging:serviceName()
</code></pre>

<pre><code class="lua">sdkbox.PluginPhunwareMessaging:version()
</code></pre>

<pre><code class="lua">sdkbox.PluginPhunwareMessaging:stop()
</code></pre>

<pre><code class="lua">sdkbox.PluginPhunwareMessaging:messages()
</code></pre>

<pre><code class="lua">sdkbox.PluginPhunwareMessaging:geozones()
</code></pre>

<h3 id="listeners">Listeners</h3>
<pre><code class="lua">init(success, message)
</code></pre>

<blockquote>
<p>Notifies the delegate that the module has finished loading</p>
</blockquote>
<pre><code class="lua">error(message)
</code></pre>

<pre><code class="lua">notification(notifi)
</code></pre>

<h2 id="manual-integration">Manual Integration</h2>
<p>If the <em>SDKBOX Installer</em> <strong>fails</strong> to complete successfully, it is possible to integrate SDKBOX manually. If the installer complete successfully, please <strong>do not</strong> complete anymore of this document. It is not necessary.</p>
<p>These steps are listed last in this document on purpose as they are seldom needed. If you find yourself using these steps, please, after completing, double back and re-read the steps above for other integration items.</p>
<h2 id="manual-integration-for-ios">Manual Integration For iOS</h2>
<p>Drag and drop the following frameworks from the <strong>plugins/ios</strong> folder of the <code>PhunwareAds</code> bundle into your Xcode project</p>
<blockquote>
<p>check <code>Copy items if needed</code> when adding frameworks:</p>
<p>sdkbox.framework</p>
<p>PluginPhunwareMessaging.framework</p>
<p>PWCore.framework</p>
<p>PWMessaging.framework</p>
</blockquote>
<p>The above frameworks depend upon other frameworks. You also need to add the
following system frameworks</p>
<blockquote>
<p>if you don't already have them:</p>
<p>CoreLocation.framework</p>
<p>libz.tbd</p>
<p>libsqlite3.tbd</p>
<p>SystemConfiguration.framework</p>
<p>GameController.framework</p>
<p>MediaPlayer.framework</p>
<p>MobileCoreServices.framework</p>
<p>CoreTelephony.framework</p>
</blockquote>
<p>Copy all source and header files from <code>plugin/luabindings/</code> to your projects <code>Classes</code> folder.</p>
<p>Add these same files, that you just copied, to Xcode by either dragging and dropping them into Xcode or by using <strong>File -&gt; Add files to...</strong>.</p>
<h2 id="manual-integration-for-android">Manual Integration For Android</h2>
<p>SDKBOX supports three different kinds of <strong>Android</strong> projects <strong>command-line</strong>, <strong>eclipse</strong> and <strong>Android Studio</strong>. </p>
<ul>
<li><code>proj.android</code> will be used as our <code>&lt;project_root&gt;</code> for <strong>command-line</strong> and <strong>eclipse</strong> project</li>
<li><code>proj.android-studio</code> will be used as our <code>&lt;project_root&gt;</code> for <strong>Android Studio</strong> project.</li>
</ul>
<p><strong>NOTE</strong>: not support eclipse project right now</p>
<h3 id="copy-files">Copy Files</h3>
<p>Copy the following <strong>jar</strong> files from <code>plugin/android/libs</code> folder of this
bundle into your project’s <strong><project_root>/libs</strong> folder.</p>
<blockquote>
<p>sdkbox.jar</p>
</blockquote>
<ul>
<li>
<p>If you're using cocos2d-x from source copy the <strong>jar</strong> files to:</p>
<p>Android Studio:
<code>cocos2d/cocos/platform/android/libcocos2dx/libs</code></p>
</li>
<li>
<p>If you're using cocos2d-js or lua copy the <strong>jar</strong> files to:</p>
<p>Android Studio:
<code>frameworks/cocos2d-x/cocos/platform/android/libcocos2dx/libs</code></p>
</li>
</ul>
<h4 id="copy-jni-libs">Copy jni libs</h4>
<p>Copy and overwrite all the folders from <code>plugin/android/jni</code>
to your <code>&lt;project_root&gt;/jni/</code> directory.</p>
<blockquote>
<p>Note: sdkbox link with <code>gnustl</code> by default, if your project link with <code>c++static</code> please replace the files in <code>&lt;project_root&gt;/jni/&lt;plugin_name&gt;/libs</code> with files in <code>&lt;project_root&gt;/jni/&lt;plugin_name&gt;/libs_c++_static</code> folder</p>
</blockquote>
<h3 id="edit-androidmanifestxml">Edit <code>AndroidManifest.xml</code></h3>
<p>Include the following permissions above the <strong>application tag</strong>:</p>
<pre><code class="xml">&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;
</code></pre>

<p>To enable <strong>hardware acceleration</strong> in your <strong>application tag</strong>. This tag is
optional on newer SDK versions and doesn't work on version 2.3.3.</p>
<pre><code class="xml">&lt;android:hardwareAccelerated=&quot;true&quot; /&gt;
</code></pre>

<h3 id="edit-androidmk">Edit <code>Android.mk</code></h3>
<p>Edit <code>&lt;project_root&gt;/jni/Android.mk</code> to:</p>
<p>Add additional requirements to <strong>LOCAL_WHOLE_STATIC_LIBRARIES</strong>:</p>
<pre><code>LOCAL_WHOLE_STATIC_LIBRARIES += PluginPhunwareMessaging
LOCAL_WHOLE_STATIC_LIBRARIES += sdkbox
</code></pre>

<p>Add a call to:</p>
<pre><code>$(call import-add-path,$(LOCAL_PATH))
</code></pre>

<p>before any <strong>import-module</strong> statements.</p>
<p>Add additional <strong>import-module</strong> statements at the end:</p>
<pre><code>$(call import-module, ./sdkbox)
$(call import-module, ./pluginphunwaremessaging)
</code></pre>

<p>This means that your ordering should look similar to this:</p>
<pre><code>$(call import-add-path,$(LOCAL_PATH))
$(call import-module, ./sdkbox)
$(call import-module, ./pluginphunwaremessaging)
</code></pre>

<p><strong>Note:</strong> It is important to make sure these statements are above the existing <code>$(call import-module,./prebuilt-mk)</code> statement, if you are using the pre-built libraries.</p>
<h3 id="modify-applicationmk-cocos2d-x-v30-to-v32-only">Modify <code>Application.mk</code> (Cocos2d-x v3.0 to v3.2 only)</h3>
<p>Edit <code>&lt;project_root&gt;/jni/Application.mk</code> to make sure <strong>APP_STL</strong> is defined
correctly. If <code>Application.mk</code> contains <code>APP_STL := c++_static</code>, it should be
changed to:</p>
<pre><code>APP_STL := gnustl_static
</code></pre>

<p>Add <strong>APP_PATFORM</strong> version requirements:</p>
<pre><code>APP_PLATFORM := android-16
</code></pre>

<h3 id="edit-androidmanifestxml_1">Edit <code>AndroidManifest.xml</code></h3>
<p>Edit <code>manifest</code>. Example:</p>
<pre><code>```
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
          package="org.cocos2dx.cpp3141"
          xmlns:ns1="http://schemas.android.com/tools" &lt;!-- ADD THIS LINE --&gt;
          android:installLocation="auto" android:versionCode="1"
          android:versionName="1.0"&gt;
```
</code></pre>
<p>Edit <code>application</code>. Example:</p>
<pre><code>```
&lt;application android:icon="@drawable/icon"
             ns1:replace="android:label" &lt;!-- ADD THIS LINE --&gt;
             android:label="@string/app_name" &gt;

    &lt;!-- ADD START--&gt;
    &lt;activity android:name=".AppActivity"&gt;
        &lt;intent-filter&gt;
            &lt;action android:name="android.intent.action.VIEW" /&gt;
            &lt;category android:name="android.intent.category.DEFAULT" /&gt;
            &lt;data android:mimeType="locationmessaging/message" /&gt;
        &lt;/intent-filter&gt;
    &lt;/activity&gt;
    &lt;!-- ADD END--&gt;

&lt;/application&gt;
```
</code></pre>
<h3 id="edit-buildgradle">Edit <code>build.gradle</code></h3>
<p>Edit <code>cocos2d/cocos/platform/android/libcocos2dx/build.gradle</code>. Example:</p>
<pre><code>```
...
android {
    compileSdkVersion 23                    # THIS LINE
    buildToolsVersion "23.0.3"              # THIS LINE
    useLibrary  'org.apache.http.legacy'    # THIS LINE


    defaultConfig {
        minSdkVersion 16                    # THIS LINE
        targetSdkVersion 22                 # THIS LINE
        versionCode 1
        versionName "1.0"
    }

    ...
}
...
```
</code></pre>
<p>Edit <code>proj.android-studio/app/build.gradle</code></p>
<pre><code>```
android {
+    compileSdkVersion 23
+    buildToolsVersion "23.0.3"
+    useLibrary  'org.apache.http.legacy'

     defaultConfig {
         applicationId "org.cocos2dx.cpp3141"   &lt;!-- MUST SAME WITH google-services.json --&gt;
+        minSdkVersion 16
         targetSdkVersion 22
         versionCode 1
         versionName "1.0"

         ...

     buildTypes {
+        debug {
+            ndk {
+                abiFilters = ["armeabi"]
+            }
+        }
+
         release {
+            ndk {
+                abiFilters = ["armeabi"]
+            }
+
             minifyEnabled false
             proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
             if (project.hasProperty("RELEASE_STORE_FILE")) {

             ...

 dependencies {
+    compile 'com.google.android.gms:play-services-maps:9.6.1'
+    compile 'com.android.support:appcompat-v7:23.3.0'
+    compile 'com.phunware.messaging:messaging:3.0.4'
     compile fileTree(dir: 'libs', include: ['*.jar'])
     compile project(':libcocos2dx')
 }

 clean.dependsOn cleanAssets
 preBuild.dependsOn copyAssets
+
+apply plugin: 'com.google.gms.google-services'
```
</code></pre>
<p>Edit <code>proj.android-studio/build.gradle</code></p>
<pre><code>```
         // NOTE: Do not place your application dependencies here; they belong
         // in the individual module build.gradle files
+        classpath 'com.google.gms:google-services:3.0.0'
+
     }
 }

 allprojects {
     repositories {
         jcenter()
+        maven {
+            url "https://nexus.phunware.com/content/groups/public/"
+        }
     }
 }
```
</code></pre>
<p>Copy all source and header files from <code>plugin/luabindings/</code> to your projects <code>Classes</code> folder.</p>
<p>Add all <code>.cpp</code> files, that you just copied, to <code>Android.mk</code> in the <strong>LOCAL_SRC_FILES</strong> section. Example</p>
<pre><code>LOCAL_SRC_FILES := hellocpp/main.cpp \
                ../../Classes/AppDelegate.cpp \
                ../../Classes/HelloWorldScene.cpp \
                                ../../Classes/NewSourceFile.cpp
</code></pre>

<h3 id="modify-cocos2dxactivityjava">Modify <strong>Cocos2dxActivity.java</strong></h3>
<ul>
<li>
<p>If you're using cocos2d-x from source, assuming you are in the <strong>proj.android</strong> directory, <strong>Cocos2dxActivity.java</strong> is located:</p>
<p><code>../../cocos2d-x/cocos/platform/android/java/src/org/cocos2dx/
lib/Cocos2dxActivity.java</code></p>
</li>
<li>
<p>If you're using the prebuilt cocos2d-x libraries assuming you are in the <code>proj.android</code> directory, <strong>Cocos2dxActivity.java</strong> is located:</p>
<p><code>./src/org/cocos2dx/lib/Cocos2dxActivity.java</code></p>
</li>
</ul>
<p><strong>Note:</strong> When using Cocos2d-x from source, different versions have <strong>Cocos2dxActivity.java</strong> in a different location. One way to find the location is to look in <strong>proj.android/project.properties</strong>. Example:
  <code>android.library.reference.1=../../cocos2d-x/cocos/platform/android/java</code></p>
<p>In this case, <strong>Cocos2dxActivity.java</strong> should be located at:</p>
<pre><code>../../cocos2d-x/cocos/platform/android/java/src/org/cocos2dx/lib/Cocos2dxActivity.java
</code></pre>

<ul>
<li>Modify <strong>Cocos2dxActivity.java</strong> to add the following imports:</li>
</ul>
<pre><code class="java">import android.content.Intent;
import com.sdkbox.plugin.SDKBox;
</code></pre>

<ul>
<li>Second, modify <strong>Cocos2dxActivity.java</strong> to edit the <code>onCreate(final Bundle savedInstanceState)</code> function to add a call to <code>SDKBox.init(this);</code>. The placement of this call is important. It must be done after the call to <code>onLoadNativeLibraries();</code>. Example:</li>
</ul>
<pre><code class="java">onLoadNativeLibraries();
SDKBox.init(this);
</code></pre>

<ul>
<li>
<p>Last, we need to insert the proper <strong>overrides</strong> code. There are a few rules here.</p>
<ul>
<li>
<p>If the method listed has not been defined, <strong>add it</strong>.</p>
</li>
<li>
<p>If the method listed has been defined, add the calls to <code>SDKBox</code> in the <strong>same</strong> existing function.</p>
</li>
</ul>
</li>
</ul>
<pre><code class="java">    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
          if(!SDKBox.onActivityResult(requestCode, resultCode, data)) {
            super.onActivityResult(requestCode, resultCode, data);
          }
    }
    @Override
    protected void onStart() {
          super.onStart();
          SDKBox.onStart();
    }
    @Override
    protected void onStop() {
          super.onStop();
          SDKBox.onStop();
    }
    @Override
    protected void onResume() {
          super.onResume();
          SDKBox.onResume();
    }
    @Override
    protected void onPause() {
          super.onPause();
          SDKBox.onPause();
    }
    @Override
    public void onBackPressed() {
          if(!SDKBox.onBackPressed()) {
            super.onBackPressed();
          }
    }
</code></pre>

<h2 id="proguard-optional">Proguard (optional)</h2>
<ul>
<li>Edit <code>project.properties</code>  to specify a <code>Proguard</code> configuration file. Example:</li>
</ul>
<pre><code>proguard.config=${sdk.dir}/tools/proguard/proguard-android.txt:proguard-project.txt
</code></pre>

<ul>
<li>Edit the file you specified to include the following:</li>
</ul>
<pre><code># phunwaremessaging
-keep class * implements android.os.Parcelable {
    public static final android.os.Parcelable$Creator *;
}
-dontwarn okio.**
-dontwarn okhttp3.**


# cocos2d-x
-keep public class org.cocos2dx.** { *; }
-dontwarn org.cocos2dx.**
-keep public class com.chukong.** { *; }
-dontwarn com.chukong.**

# google play service
-keep public class com.google.android.gms.** { public *; }
-dontwarn com.google.android.gms.**

-keep class * extends java.util.ListResourceBundle {
    protected Object[][] getContents();
}

-keep public class com.google.android.gms.common.internal.safeparcel.SafeParcelable {
    public static final *** NULL;
}

-keepnames @com.google.android.gms.common.annotation.KeepName class *
-keepclassmembernames class * {
    @com.google.android.gms.common.annotation.KeepName *;
}

-keepnames class * implements android.os.Parcelable {
    public static final ** CREATOR;
}

#sdkbox
-keep class com.sdkbox.** { *; }
-dontwarn com.sdkbox.**
</code></pre>

<p><strong>Note:</strong> Proguard only works with <strong>Release</strong> builds (i.e <code>cocos run -m release</code>) debug builds do not invoke Proguard rules.</p>
<h2 id="notice">Notice</h2>
<p>SDKBox PhunwareMessaging v3.5.1+ android Required:</p>
<ol>
<li>Build SDK Version - 23</li>
<li>Compile SDK Version - 23</li>
</ol>
<p>if you get <code>miss HttpClient</code> error when set build sdk to 23:</p>
<ol>
<li>if use android studio, add this to your gradle:</li>
</ol>
<pre><code class="groovy">android {
    useLibrary 'org.apache.http.legacy'
}
</code></pre></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        
        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script>var base_url = '../../..';</script>
        <script src="../../../js/base.js"></script>
        

 
        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-70044300-2', 'auto');
            ga('send', 'pageview');
        </script>
        
    </body>
</html>
