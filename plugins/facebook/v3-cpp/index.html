<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">

	<title>Facebook with C++ - SDKBOX</title>
        
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../../css/base.css?2" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">
        <link href="../../../css/custom.css" rel="stylesheet">
        

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="http://sdkbox.com"><img src="http://www.cocos2d-x.org/s/sdkbox/SDKBOX_logo.png">Docs</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">

            <ul class="nav navbar-nav navbar-right">


            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Overview</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cocos2d-x <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../cocos/">Overview</a>
</li>

                        
                            
<li >
    <a href="../../../installer/">CLI Installer</a>
</li>

                        
                            
<li >
    <a href="../../../qa/cocos_creator/">For Cocos Creator</a>
</li>

                        
                            
  
  <li class="dropdown-submenu">
    <a tabindex="-1" class="non-link">Plugins</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../achievement/">Achievements</a>
</li>

        
            
  

        
            
<li >
    <a href="../../adcolony/">AdColony</a>
</li>

        
            
  

        
            
<li >
    <a href="../../admob/">AdMob</a>
</li>

        
            
  

        
            
<li >
    <a href="../../agecheq/">AgeCheq</a>
</li>

        
            
  

        
            
<li >
    <a href="../../appnext/">Appnext</a>
</li>

        
            
  

        
            
<li >
    <a href="../../appodeal/">Appodeal</a>
</li>

        
            
  

        
            
<li >
    <a href="../../amazon/">Amazon</a>
</li>

        
            
  

        
            
<li >
    <a href="../../apteligent/">Apteligent</a>
</li>

        
            
  

        
            
<li >
    <a href="../../bee7/">Bee7</a>
</li>

        
            
  

        
            
<li >
    <a href="../../chartboost/">Chartboost</a>
</li>

        
            
  

        
            
<li >
    <a href="../../ethwallet/">EthWallet</a>
</li>

        
            
<li >
    <a href="../">Facebook</a>
</li>

        
            
  

        
            
<li >
    <a href="../../gameroom/">Facebook Gameroom</a>
</li>

        
            
  

        
            
<li >
    <a href="../../firebase/">Firebase</a>
</li>

        
            
  

        
            
<li >
    <a href="../../flurryanalytics/">Flurry Analytics</a>
</li>

        
            
  

        
            
<li >
    <a href="../../fyber/">Fyber</a>
</li>

        
            
  

        
            
<li >
    <a href="../../googleanalytics/">Google Analytics</a>
</li>

        
            
  

        
            
<li >
    <a href="../../googleplay/">Google Play Games</a>
</li>

        
            
  

        
            
<li >
    <a href="../../hms/">Huawei Mobile Services</a>
</li>

        
            
  

        
            
<li >
    <a href="../../iap/">In-App Purchase</a>
</li>

        
            
  

        
            
<li >
    <a href="../../inmobi/">InMobi</a>
</li>

        
            
  

        
            
<li >
    <a href="../../kochava/">Kochava</a>
</li>

        
            
  

        
            
<li >
    <a href="../../leadbolt/">LeadBolt</a>
</li>

        
            
  

        
            
<li >
    <a href="../../leaderboard/">Leaderboard</a>
</li>

        
            
  

        
            
<li >
    <a href="../../misc/">Misc</a>
</li>

        
            
  

        
            
<li >
    <a href="../../onesignal/">OneSignal</a>
</li>

        
            
  

        
            
<li >
    <a href="../../playphone/">Playphone</a>
</li>

        
            
  

        
            
<li >
    <a href="../../phunwareads/">Phunware Ads</a>
</li>

        
            
  

        
            
<li >
    <a href="../../phunwaremessaging/">Phunware Messaging</a>
</li>

        
            
  

        
            
<li >
    <a href="../../review/">Ratings & Reviews</a>
</li>

        
            
  

        
            
<li >
    <a href="../../sdkboxads/">SDKBOX Ads</a>
</li>

        
            
  

        
            
<li >
    <a href="../../sdkboxplay/">SDKBOX Play</a>
</li>

        
            
  

        
            
<li >
    <a href="../../share/">Social Sharing</a>
</li>

        
            
  

        
            
<li >
    <a href="../../signinwithapple/">Sign in with Apple</a>
</li>

        
            
  

        
            
<li >
    <a href="../../tapcore/">Tapcore</a>
</li>

        
            
  

        
            
<li >
    <a href="../../tune/">Tune</a>
</li>

        
            
  

        
            
<li >
    <a href="../../unityads/">UnityAds</a>
</li>

        
            
  

        
            
<li >
    <a href="../../valuepotion/">Valuepotion</a>
</li>

        
            
  

        
            
<li >
    <a href="../../vungle/">Vungle</a>
</li>

        
            
  

        
            
<li >
    <a href="../../youtube/">Youtube</a>
</li>

        
            
  

        
    </ul>
  </li>
  

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Unity <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../unity/allinone/">SDKBOX AllInOne</a>
</li>

                        
                            
<li >
    <a href="../../../unity/iap/">In-App Purchase</a>
</li>

                        
                            
<li >
    <a href="../../../unity/review/">Ratings & Reviews</a>
</li>

                        
                            
<li >
    <a href="../../../unity/socialshare/">SocialShare</a>
</li>

                        
                            
<li >
    <a href="../../../unity/googleanalytics/">Google Analytics</a>
</li>

                        
                            
<li >
    <a href="../../../unity/sdkboxplay/">SDKBOX Play</a>
</li>

                        
                            
<li >
    <a href="../../../unity/addeals/">AdDeals</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Unreal <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../unreal/iap/">In-App Purchase</a>
</li>

                        
                            
<li >
    <a href="../../../unreal/chartboost/">Chartboost</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">LiveOps <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../liveops/">Setup</a>
</li>

                        
                            
<li >
    <a href="../../../liveops/remote-config/">Remote Configuration</a>
</li>

                        
                            
<li >
    <a href="../../../liveops/receipt-verification/">Server-side IAP receipt verification</a>
</li>

                        
                            
<li >
    <a href="../../../liveops/catalog-management/">On-the-fly catalog management</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../qa/install_sdkbox/">Install SDKBox</a>
</li>

                        
                            
<li >
    <a href="../../../qa/from-google-to-amazon/">From Google to Amazon</a>
</li>

                        
                            
<li >
    <a href="../../../qa/integration-admob-to-creator/">Admob in Creator</a>
</li>

                        
                            
<li >
    <a href="../../../qa/integration-fyber-to-cocos/">Fyber with Cocos2d-x</a>
</li>

                        
                            
<li >
    <a href="../../../qa/fb-share-on-cocos/">Facebook with Cocos2d-x</a>
</li>

                        
                            
<li >
    <a href="../../../qa/android_64k/">Fix Android 64K methods limit</a>
</li>

                        
                            
<li >
    <a href="../../../qa/integration-iap-on-unity/">IAP with Unity</a>
</li>

                        
                            
<li >
    <a href="../../../qa/use-gui-integration-ga-to-creator/">GA with SDKBox GUI in Creator</a>
</li>

                        
                            
<li >
    <a href="../../../qa/use-custom-activity-on-unity/">Unity Custom Activity</a>
</li>

                        
                            
<li >
    <a href="../../../qa/crypt-sdkbox-config/">Encrypt Decrypt sdkbox_config.json</a>
</li>

                        
                            
<li >
    <a href="../../../qa/sdkboxplay_troubleshoot/">SDKBoxPlay Troubleshoot</a>
</li>

                        
                            
<li >
    <a href="../../../qa/iap_troubleshoot/">IAP Troubleshoot</a>
</li>

                        
                            
<li >
    <a href="../../../qa/sdkbox-cmake/">CMake</a>
</li>

                        
                            
<li >
    <a href="../../../qa/cmake_xcframework/">CMake With XCFramework</a>
</li>

                        
                            
<li >
    <a href="../../../qa/faq/">FAQ</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../../release-note/">About</a>
                    </li>
                
                

                <li style="margin-left:30px">
                    <a href="http://sdkbox-doc.github.io/zh/">中文</a>
                </li>
                
                </ul>
            




            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#prerequisites">Prerequisites</a></li>
	
    
        <li class="main "><a href="#sdk-version">SDK Version</a></li>
	
    
        <li class="main "><a href="#integration">Integration</a></li>
	
    
        <li class="main "><a href="#important-notice">Important Notice</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#disable-app-transport-security">Disable App Transport Security</a></li>
        
            <li><a href="#disable-bitcode-support">Disable Bitcode support</a></li>
        
            <li><a href="#set-your-game-requires-full-screen">Set your game requires full screen</a></li>
        
            <li><a href="#whitelist-canopenurl-function">Whitelist canOpenURL function</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#faq">FAQ</a></li>
	
    
        <li class="main "><a href="#extra-steps">Extra steps</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#setup-ios">Setup iOS</a></li>
        
            <li><a href="#setup-android">Setup Android</a></li>
        
            <li><a href="#json-configuration">JSON Configuration</a></li>
        
            <li><a href="#facebook-app-links-host">~~Facebook App Links Host~~</a></li>
        
            <li><a href="#invite-friends">~~Invite Friends~~</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#usage">Usage</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#initialize-facebook">Initialize Facebook</a></li>
        
            <li><a href="#using-facebook">Using Facebook</a></li>
        
            <li><a href="#graph-api">Graph API</a></li>
        
            <li><a href="#facebook-events">Facebook events</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#api-reference">API Reference</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#methods">Methods</a></li>
        
            <li><a href="#listeners">Listeners</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#manual-integration">Manual Integration</a></li>
	
    
        <li class="main "><a href="#manual-integration-for-ios">Manual Integration For iOS</a></li>
	
    
        <li class="main "><a href="#manual-integration-for-android">Manual Integration For Android</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#copy-files">Copy Files</a></li>
        
            <li><a href="#edit-androidmanifestxml">Edit AndroidManifest.xml</a></li>
        
            <li><a href="#edit-stringsxml">Edit strings.xml</a></li>
        
            <li><a href="#edit-androidmk">Edit Android.mk</a></li>
        
            <li><a href="#modify-applicationmk-cocos2d-x-v30-to-v32-only">Modify Application.mk (Cocos2d-x v3.0 to v3.2 only)</a></li>
        
            <li><a href="#modify-projectproperties">Modify project.properties</a></li>
        
            <li><a href="#modify-appactivityjava">Modify AppActivity.java</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#proguard-optional">Proguard (optional)</a></li>
	
    
        <li class="main "><a href="#facebook-compile-issue">Facebook Compile Issue</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#solution-a">solution A</a></li>
        
            <li><a href="#solution-b">solution B</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#facebook-compile-issue_1">Facebook Compile Issue</a></li>
	
    
        <li class="main "><a href="#facebook-crash-issue">Facebook Crash Issue</a></li>
	
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p><a href="../">&#8249; Facebook Doc Home</a></p>
<h1>Facebook Integration Guide</h1>

<h4><em><b>For the C++ version of cocos2d-x v3.x</b> - (<a href="./../">all other versions</a>)</em></h4>

<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li><strong>For Android</strong>, Facebook requires a minimum version of <strong>API 15: Android 4.0.3</strong>. This version is newer than what the other SDKBOX plugins require.</li>
</ul>
<h2 id="sdk-version">SDK Version</h2>
<ul>
<li>ios: 5.12.0</li>
<li>android: 4.34.0</li>
</ul>
<h2 id="integration">Integration</h2>
<p>Open a terminal and use the following command to install the SDKBOX Facebook plugin. Make sure you setup the SDKBOX installer correctly.</p>
<pre><code class="bash">$ sdkbox import facebook
</code></pre>

<h2 id="important-notice">Important Notice</h2>
<p>Please make sure the following settings in your project to make the plugin work well.</p>
<h4 id="disable-app-transport-security">Disable App Transport Security</h4>
<p>Adding the following entry to the <code>info.plist</code> file:</p>
<pre><code>&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;
&lt;dict&gt;
    &lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;
    &lt;true/&gt;
&lt;/dict&gt;
</code></pre>

<p>It should look like this:</p>
<p><img alt="" src="../../../imgs/ATS.png" /></p>
<h4 id="disable-bitcode-support">Disable Bitcode support</h4>
<p>You have to turn off <strong>Bitcode</strong> support. If you don't, cocos2d-x will fail to build.</p>
<h4 id="set-your-game-requires-full-screen">Set your game requires full screen</h4>
<p>If your game doesn't support all screen orientations, you will need to check <code>Requires full screen</code> in Xcode. If you do not, your app will fail Apple's submission process.</p>
<h4 id="whitelist-canopenurl-function">Whitelist canOpenURL function</h4>
<p>This setting depends on what plugins are in your project. You may need to add the required entry to the <code>info.plist</code>, under <code>LSApplicationQueriesSchemes</code>.</p>
<p>Follow <a href="https://developers.facebook.com/docs/ios/ios9">this link</a></p>
<h2 id="faq">FAQ</h2>
<ol>
<li>If you want to switch Facebook Login behavior (Facebook Native App / Web Dialog), <a href="https://support.apple.com/en-us/HT201265">clear Safari Cookie</a></li>
<li>If you want to switch Facebook Login Account, <a href="https://support.apple.com/en-us/HT201265">clear Safari Cookie</a></li>
</ol>
<h2 id="extra-steps">Extra steps</h2>
<p>The following step assuming you already registered as a Facebook Developer
And created a new <strong>APP</strong> on Facebook, If not please follow up the <strong>Setup Facebook App</strong> section below.</p>
<h3 id="setup-ios">Setup iOS</h3>
<ul>
<li>Configure your <strong>APP</strong> following <a href="https://developers.facebook.com/quickstarts/?platform=ios">iOS Quick Start Guide</a></li>
<li>Special for iOS9 <a href="https://developers.facebook.com/docs/ios/ios9">https://developers.facebook.com/docs/ios/ios9</a></li>
<li>Apply the code change to <code>AppController.mm</code> instead of <code>AppDelegate.cpp</code></li>
</ul>
<pre><code>#import &lt;FBSDKCoreKit/FBSDKCoreKit.h&gt;

- (BOOL)application:(UIApplication *)application
    didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {

  //
  // **************************
  // !! IMPORTANT !!
  // **************************
  //
  // call [[FBSDKApplicationDelegate sharedInstance] application:didFinishLaunchingWithOptions
  // before app-&gt;run()

  [[FBSDKApplicationDelegate sharedInstance] application:application
    didFinishLaunchingWithOptions:launchOptions];

  app-&gt;run();

  return YES;
}

- (BOOL)application:(UIApplication *)application
            openURL:(NSURL *)url
            options:(NSDictionary&lt;UIApplicationOpenURLOptionsKey,id&gt; *)options {

  BOOL handled = [[FBSDKApplicationDelegate sharedInstance] application:application
    openURL:url
    sourceApplication:options[UIApplicationOpenURLOptionsSourceApplicationKey]
    annotation:options[UIApplicationOpenURLOptionsAnnotationKey]
  ];
  // Add any custom logic here.
  return handled;
}

- (BOOL)application:(UIApplication *)application
            openURL:(NSURL *)url
  sourceApplication:(NSString *)sourceApplication
         annotation:(id)annotation {

  BOOL handled = [[FBSDKApplicationDelegate sharedInstance] application:application
    openURL:url
    sourceApplication:sourceApplication
    annotation:annotation
  ];
  // Add any custom logic here.
  return handled;
}

</code></pre>

<p>login doesn't work on simulator on iOS 10, Xcode8</p>
<pre><code>Go to the Project Target and then Capabilities and switch Keychain Sharing ON.
</code></pre>

<p>http://stackoverflow.com/a/39788102/5443510</p>
<h3 id="setup-android">Setup Android</h3>
<ul>
<li>Make sure <code>java -version</code> &gt;= 1.7</li>
<li>Configure your <strong>APP</strong> on Facebook follow <a href="https://developers.facebook.com/quickstarts/?platform=android">Android Quick Start Guide</a></li>
<li>Open <code>res/values/strings.xml</code> and replace <code>facebook_app_id</code> with your <code>Facebook App ID</code></li>
<li>Open <code>AndroidManifest.xml</code> and replace <code>_replace_with_your_app_id_</code> with your <code>Facebook App ID</code></li>
<li>Open <code>project.properties</code> and change target to <code>target=android-15</code></li>
</ul>
<!--## Configuration

## Remote Configuration

Optionally, you can choose to use SDKBOX LiveOps to remotely update this plugin's configuration. [Learn more](/liveops/remote-config)-->

<h3 id="json-configuration">JSON Configuration</h3>
<p>SDKBOX Installer will automatically create a sample configuration <code>sdkbox_config.json</code> for you</p>
<h4 id="options">options</h4>
<ul>
<li>app_id [string]:</li>
</ul>
<blockquote>
<p>The Facebook App ID to be used by the SDK.</p>
</blockquote>
<ul>
<li>url_scheme_suffix [string]: (iOS only)</li>
</ul>
<blockquote>
<p>The url scheme suffix to be used by the SDK.</p>
</blockquote>
<p>Here is an example of the Facebook configuration you can enable/disable debug mode for Facebook here</p>
<pre><code class="json">&quot;Facebook&quot;:
{
    &quot;debug&quot;:true,
    &quot;app_id&quot;:&quot;&quot;,
    &quot;url_scheme_suffix&quot;:&quot;&quot;
}
</code></pre>

<h3 id="facebook-app-links-host">~~Facebook App Links Host~~</h3>
<blockquote>
<p>With the release of the Facebook SDK version 4.28.0, App Links Hosting is deprecated. It will be supported until February 5, 2018.
https://developers.facebook.com/docs/applinks/hosting-api/</p>
</blockquote>
<ol>
<li>Get <code>APP_ACCESS_TOKEN</code> (App Token) in https://developers.facebook.com/tools/access_token/</li>
<li>Create links</li>
</ol>
<pre><code>curl https://graph.facebook.com/app/app_link_hosts \
-F access_token=&quot;APP_ACCESS_TOKEN&quot; \
-F name=&quot;iOS App Link Object Example&quot; \
-F ios=' [
    {
      &quot;url&quot; : &quot;sharesample://story/1234&quot;,
      &quot;app_store_id&quot; : 12345,
      &quot;app_name&quot; : &quot;ShareSample&quot;,
    },
  ]' \
-F web=' {
    &quot;should_fallback&quot; : false,
  }'
</code></pre>

<ol>
<li>Query link</li>
</ol>
<pre><code>curl -G https://graph.facebook.com/{YOUR_LINK_ID} \
-d access_token=&quot;APP_ACCESS_TOKEN&quot; \
-d fields=canonical_url \
-d pretty=true

# or
curl -G https://graph.facebook.com \
-d access_token=&quot;APP_ACCESS_TOKEN&quot; \
-d fields=app_links \
-d ids=https://fb.me/{YOUR_LINK_ID} \
-d pretty=true
</code></pre>

<ol>
<li>Update link</li>
</ol>
<pre><code>curl https://graph.facebook.com/{YOUR_LINK_ID} \
-F access_token=&quot;APP_ACCESS_TOKEN&quot; \
-F name=&quot;FB App Link Object Example&quot; \
-F ios=' [
    {
      &quot;url&quot; : &quot;sharesample://story/1234&quot;,
      &quot;app_store_id&quot; : 12345,
      &quot;app_name&quot; : &quot;ShareSample&quot;,
    },
  ]' \
-F web=' {
    &quot;should_fallback&quot; : false,
}'
</code></pre>

<h3 id="invite-friends">~~Invite Friends~~</h3>
<ul>
<li>http://discuss.cocos2d-x.org/t/solved-invite-friends-with-using-cocos2dx-layer/34450</li>
</ul>
<p>https://developers.facebook.com/docs/ios/change-log-4x/</p>
<blockquote>
<p>The App Invites feature has been deprecated. (4.28.0 - November 7, 2017)</p>
</blockquote>
<p>You need a canvas version of your game, but you can submit an empty/placeholder canvas version.</p>
<p>'Dashboard' -&gt; 'Settings' -&gt; 'Basic' -&gt; 'Add Platform'</p>
<blockquote>
<p>Navigate to your app's <a href="https://developers.facebook.com/apps/">Facebook settings</a>. Go to the ‘Facebook Web Games' pane in the Basic tab of your app's ‘Settings' page and fill in the ‘Facebook Web Games URL (https)' field with the URL where you are serving your game. Now save your changes.</p>
</blockquote>
<p><img alt="preview" src="https://scontent-lax3-1.xx.fbcdn.net/v/t39.2178-6/16781471_393759444334692_3641607580918218752_n.PNG?_nc_cat=0&amp;oh=2ac23410835c91da267971b1460f2d64&amp;oe=5B74F3CE" /></p>
<!---->

<h2 id="usage">Usage</h2>
<h3 id="initialize-facebook">Initialize Facebook</h3>
<p>Initialize the plugin where appropriate in your code. We recommend to do this in the <code>AppDelegate::applicationDidFinishLaunching()</code> or <code>AppController:didFinishLaunchingWithOptions()</code>. Make sure to include the appropriate headers:</p>
<pre><code class="cpp">#include &quot;PluginFacebook/PluginFacebook.h&quot;
AppDelegate::applicationDidFinishLaunching()
{
     sdkbox::PluginFacebook::init();
}
</code></pre>

<h3 id="using-facebook">Using Facebook</h3>
<h4 id="login">Login</h4>
<p>First the user needs to login to Facebook in order to use it.</p>
<pre><code class="cpp">sdkbox::PluginFacebook::login();
</code></pre>

<p>If a user doesn't want to use Facebook functionality anymore, logout.</p>
<pre><code class="cpp">sdkbox::PluginFacebook::logout();
</code></pre>

<p>You can check whether user already logged in using</p>
<pre><code class="cpp">sdkbox::PluginFacebook::isLoggedIn();
</code></pre>

<blockquote>
<p>Note: user only needs to perform login once, unless they logout</p>
</blockquote>
<h4 id="permissions">Permissions</h4>
<p>Facebook requires you to ask for the user's permission before you can perform actions, such as, posting on the user's behalf.
There are two types of permission <strong>read</strong> and <strong>publish</strong>
You can get a complete list of permissions <a href="https://developers.facebook.com/docs/facebook-login/permissions/v2.3#reference">here</a></p>
<p>SDKBOX provides the most commonly used permissions:</p>
<ul>
<li>FB_PERM_READ_PUBLIC_PROFILE</li>
<li>FB_PERM_READ_EMAIL</li>
<li>FB_PERM_READ_USER_FRIENDS</li>
<li>FB_PERM_PUBLISH_POST</li>
</ul>
<p>To request a permission, you do so by specifying what you want:</p>
<pre><code class="cpp">sdkbox::PluginFacebook::requestReadPermissions({FB_PERM_READ_PUBLIC_PROFILE, FB_PERM_READ_USER_FRIENDS});
sdkbox::PluginFacebook::requestPublishPermissions({FB_PERM_PUBLISH_POST});
</code></pre>

<h4 id="share">Share</h4>
<p>There are two types of sharing functionality.</p>
<ul>
<li><strong>share</strong> will automatically post to the user's wall
share a link:</li>
</ul>
<pre><code class="cpp">sdkbox::FBShareInfo info;
info.type  = sdkbox::FB_LINK;
info.link  = &quot;http://www.cocos2d-x.org&quot;;
info.title = &quot;cocos2d-x&quot;;
info.text  = &quot;Best Game Engine&quot;;
info.image = &quot;http://cocos2d-x.org/images/logo.png&quot;;
sdkbox::PluginFacebook::share(info);
</code></pre>

<p>share a photo:</p>
<pre><code class="cpp">sdkbox::FBShareInfo info;
info.type  = sdkbox::FB_PHOTO;
info.title = &quot;My Photo&quot;;
info.image = __path to image__;
sdkbox::PluginFacebook::share(info);
</code></pre>

<ul>
<li><strong>dialog</strong> will show a dialog and prompt the user to write their own comments in addition:</li>
</ul>
<p>present a share dialog:</p>
<pre><code class="cpp">sdkbox::FBShareInfo info;
info.type  = sdkbox::FB_LINK;
info.link  = &quot;http://www.cocos2d-x.org&quot;;
info.title = &quot;cocos2d-x&quot;;
info.text  = &quot;Best Game Engine&quot;;
info.image = &quot;http://cocos2d-x.org/images/logo.png&quot;;
sdkbox::PluginFacebook::dialog(info);
</code></pre>

<p>share a photo with comments:</p>
<pre><code class="cpp">sdkbox::FBShareInfo info;
info.type  = sdkbox::FB_PHOTO;
info.title = &quot;My Photo&quot;;
info.image = __path to image__;
sdkbox::PluginFacebook::dialog(info);
</code></pre>

<blockquote>
<p>Note: sharing photo with comments requires the <strong>Facebook app</strong> to be installed on the device.</p>
</blockquote>
<h4 id="invite">Invite</h4>
<p>There are both <strong>standard</strong> and <strong>custom</strong> <em>Invite</em> dialogs available to use when inviting your Friends.</p>
<p>When using the <em>standard invite dialog</em>, it is necessary to select the friends to send the invitation request too. The API call is <code>inviteFriends()</code> passing in an <strong>app link url</strong> and a <strong>preview image</strong>. Example:</p>
<pre><code class="cpp">sdkbox::PluginFacebook::inviteFriends(
  &quot;https://fb.me/322164761287181&quot;,
  &quot;http://www.cocos2d-x.org/attachments/801/cocos2dx_portrait.png&quot;);
</code></pre>

<blockquote>
<p>Note: Contrary to what it may seem the <strong>app link url</strong>, it is not an App Store or Google Play application url. You must follow the instructions on this <a href="https://developers.facebook.com/quickstarts/?platform=app-links-host">page</a>  and use the resulting url as the <strong>app_link_url</strong> parameter. Facebook hosts this file for the developer, but anyone could host their own file using this <a href="https://developers.facebook.com/docs/app-invites/android#app_links">format</a></p>
</blockquote>
<p>At runtime, a custom message can be attached to the invite request. It is not possible to set a predefined invite message.</p>
<p>Creating a <em>custom invite dialog</em> is a two step process, starting with a call to <code>requestInvitableFriends()</code> then a call to <code>inviteFriendsWithInviteIds()</code> to actually send the invites. Example:</p>
<pre><code class="cpp">std::vector&lt;std::string&gt; vec;
vec.push_back(invitable_token);
sdkbox::PluginFacebook::inviteFriendsWithInviteIds(vec, &quot;Invitation title&quot;, &quot;Invitation text up to 60 chars.&quot;);
</code></pre>

<p>The <code>requestInvitableFriends()</code> function has a <strong>Bundle(map<string,string>)</strong> parameter, where the developer can define a few flags:</p>
<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">fields</td>
<td align="left">a comma separated values of the fields you want to get from your invitable friend's profiles.</td>
</tr>
<tr>
<td align="left">exclude_ids</td>
<td align="left">a comma separated FB ids to exclude from the result.</td>
</tr>
<tr>
<td align="left">limit</td>
<td align="left">number of friends per page.</td>
</tr>
</tbody>
</table>
<p>A call to <code>requestInvitableFriends()</code> will return a different collection of friends per call, and it is Facebook's decision which ones to return first.
This function returns a <code>FBInvitableFriendsInfo</code> object, which will contain a collection of the friends data and a pagination cursor object which has URLS for requesting the next and previous page of invitable friends.</p>
<p>The <em>custom invite dialog</em> is only available for games with a <strong>canvas implementation</strong> for the Facebook application. The <strong>canvas</strong> must be defined but doesn't need to how any web content. If the <strong>canvas</strong> is not defined a <em>standard invite dialog</em> is used instead.</p>
<h3 id="graph-api">Graph API</h3>
<p>You can perform <a href="https://developers.facebook.com/docs/graph-api/overview/">Graph API</a> using the <code>api</code> function</p>
<p>For example, to get the friend list:</p>
<pre><code>sdkbox::PluginFacebook::FBAPIParam params;
sdkbox::PluginFacebook::api(&quot;/me/friends&quot;, &quot;GET&quot;, params, &quot;/me/friends&quot;);
</code></pre>

<h3 id="facebook-events">Facebook events</h3>
<p>This allows you to catch <code>Facebook</code> events so that you can perform operations after Facebook events have occurred.</p>
<ul>
<li>Allow your class to extend <code>sdkbox::FacebookListener</code> and override the functions listed:</li>
</ul>
<pre><code class="cpp">#include &quot;PluginFacebook/PluginFacebook.h&quot;
class MyClass : public sdkbox::FacebookListener
{
private:
  void onLogin(bool isLogin, const std::string&amp; msg);
  void onPermission(bool isLogin, const std::string&amp; msg);
  void onAPI(const std::string&amp; tag, const std::string&amp; jsonData);
  void onSharedSuccess(const std::string&amp; message);
  void onSharedFailed(const std::string&amp; message);
  void onSharedCancel();
};
</code></pre>

<ul>
<li>Create a <strong>listener</strong> that handles callbacks:</li>
</ul>
<pre><code class="cpp">sdkbox::PluginFacebook::setListener(this);
</code></pre>

<h2 id="api-reference">API Reference</h2>
<h3 id="methods">Methods</h3>
<pre><code class="cpp">static void init ( ) ;
</code></pre>

<blockquote>
<p>initialize the plugin instance.</p>
</blockquote>
<pre><code class="cpp">static void setListener ( FacebookListener * listener ) ;
</code></pre>

<blockquote>
<p>Set listener to listen for facebook events</p>
</blockquote>
<pre><code class="cpp">static FacebookListener * getListener ( ) ;
</code></pre>

<blockquote>
<p>Get the listener</p>
</blockquote>
<pre><code class="cpp">static void removeListener ( ) ;
</code></pre>

<blockquote>
<p>Remove the listener, and can't listen to events anymore</p>
</blockquote>
<pre><code class="cpp">static void setLoginBehavior ( int loginBehavior ) ;
</code></pre>

<blockquote>
<p>login</p>
</blockquote>
<pre><code class="cpp">static void login ( ) ;
</code></pre>

<blockquote>
<p>log in</p>
</blockquote>
<pre>
This method calls login with a single permission: sdkbox::FB_PERM_READ_PUBLIC_PROFILE
</pre>

<pre><code class="cpp">static void login ( std::vector &lt;std::string&gt; &amp; permissions ) ;
</code></pre>

<pre><code class="cpp">static void requestReadPermissions ( const std::vector &lt;std::string&gt; &amp; permissions ) ;
</code></pre>

<blockquote>
<p>log in with specific read permissions, conflict with publish permissions
https://developers.facebook.com/docs/facebook-login/permissions</p>
</blockquote>
<pre><code class="cpp">static void requestPublishPermissions ( const std::vector &lt;std::string&gt; &amp; permissions ) ;
</code></pre>

<blockquote>
<p>log in with specific public permissions
https://developers.facebook.com/docs/facebook-login/permissions</p>
</blockquote>
<pre><code class="cpp">static void logout ( ) ;
</code></pre>

<blockquote>
<p>log out</p>
</blockquote>
<pre><code class="cpp">static bool isLoggedIn ( ) ;
</code></pre>

<blockquote>
<p>Check whether the user logined or not</p>
</blockquote>
<pre><code class="cpp">static std::string getUserID ( ) ;
</code></pre>

<blockquote>
<p>get UserID</p>
</blockquote>
<pre><code class="cpp">static std::string getAccessToken ( ) ;
</code></pre>

<blockquote>
<p>get AccessToken</p>
</blockquote>
<pre><code class="cpp">static std::vector &lt;std::string&gt; getPermissionList ( ) ;
</code></pre>

<blockquote>
<p>get permissoin list</p>
</blockquote>
<pre><code class="cpp">static void share ( const FBShareInfo &amp; info ) ;
</code></pre>

<blockquote>
<p>share</p>
</blockquote>
<pre><code class="cpp">static void dialog ( const FBShareInfo &amp; info ) ;
</code></pre>

<blockquote>
<p>open a dialog of Facebook app or WebDialog (dialog with photo only avaible with native Facebook app)</p>
</blockquote>
<pre><code class="cpp">static std::string getSDKVersion ( ) ;
</code></pre>

<blockquote>
<p>return the version of Facebook SDK</p>
</blockquote>
<pre><code class="cpp">static void api ( const std::string &amp; path ,
                  const std::string &amp; method ,
                  const FBAPIParam &amp; params ,
                  const std::string &amp; tag ) ;
</code></pre>

<blockquote>
<p>use Facebook Open Graph api
https://developers.facebook.com/docs/ios/graph</p>
</blockquote>
<pre><code class="cpp">static void fetchFriends ( ) ;
</code></pre>

<blockquote>
<p>fetch friends data from Facebook</p>
</blockquote>
<pre>
This data only reflects your friends that are using the app.
The number of friends defaults to 25.
</pre>

<pre><code class="cpp">static std::vector &lt;FBGraphUser&gt; getFriends ( ) ;
</code></pre>

<blockquote>
<p>get friends info</p>
</blockquote>
<pre><code class="cpp">static bool canPresentWithFBApp ( const FBShareInfo &amp; info ) ;
</code></pre>

<blockquote>
<p>check whether can present Facebook App</p>
</blockquote>
<pre><code class="cpp">static void requestInvitableFriends ( const FBAPIParam &amp; ) ;
</code></pre>

<blockquote>
<p>Get a vector of invitable friends info which can be used to build a custom friends invite dialog.</p>
</blockquote>
<pre>
The default set will be limited to 25 friends.
The order in which FB sorts the friends, and which ones returns vary between calls.
The returned invitation tokens are not supposed to be long-term stored and may vary between
calls for the same friends.
The application must have a canvas configuration for this API call to work.
</pre>

<pre><code class="cpp">static void inviteFriendsWithInviteIds ( const std::vector &lt;std::string&gt; &amp; invite_ids ,
                                         const std::string &amp; title ,
                                         const std::string &amp; invite_text ) ;
</code></pre>

<blockquote>
<p>Invite friends based on the result obtained from a call to <code>requestInvitableFriends</code></p>
</blockquote>
<pre><code class="cpp">static void inviteFriends ( const std::string &amp; app_link_url ,
                            const std::string &amp; preview_image_url ) ;
</code></pre>

<blockquote>
<p>Use the default FB dialog to invite friends.</p>
</blockquote>
<pre><code class="cpp">static void setAppId ( const std::string &amp; appId ) ;
</code></pre>

<blockquote>
<p>Set the Facebook App ID to be used by the FB SDK.</p>
</blockquote>
<pre><code class="cpp">static void setAppURLSchemeSuffix ( const std::string &amp; appURLSchemeSuffix ) ;
</code></pre>

<blockquote>
<p>Set the app url scheme suffix used by the FB SDK.</p>
</blockquote>
<pre><code class="cpp">static void requestGift ( const std::vector &lt;std::string&gt; &amp; invite_ids ,
                          const std::string &amp; object_id ,
                          const std::string &amp; message ,
                          const std::string &amp; title = &quot;&quot; ,
                          const std::string &amp; additional_data = &quot;&quot; ) ;
</code></pre>

<blockquote>
<p>Ask friends for a gift</p>
</blockquote>
<pre><code class="cpp">static void sendGift ( const std::vector &lt;std::string&gt; &amp; friend_ids ,
                       const std::string &amp; object_id ,
                       const std::string &amp; title ,
                       const std::string &amp; message ,
                       const std::string &amp; additional_data = &quot;&quot; ) ;
</code></pre>

<blockquote>
<p>Send friend a gift</p>
</blockquote>
<pre><code class="cpp">static void logEvent ( const std::string &amp; eventName ) ;
</code></pre>

<blockquote>
<p>Log event</p>
</blockquote>
<pre><code class="cpp">static void logEvent ( const std::string &amp; eventName , float valueToSum ) ;
</code></pre>

<blockquote>
<p>Log event with value</p>
</blockquote>
<pre><code class="cpp">static void logPurchase ( float mount , const std::string &amp; currency ) ;
</code></pre>

<blockquote>
<p>Log purchase event</p>
</blockquote>
<h3 id="listeners">Listeners</h3>
<pre><code class="cpp">void onLogin ( bool isLogin , const std::string &amp; msg );
</code></pre>

<pre><code class="cpp">void onSharedSuccess ( const std::string &amp; message );
</code></pre>

<pre><code class="cpp">void onSharedFailed ( const std::string &amp; message );
</code></pre>

<pre><code class="cpp">void onSharedCancel ( );
</code></pre>

<pre><code class="cpp">void onAPI ( const std::string &amp; key , const std::string &amp; jsonData );
</code></pre>

<pre><code class="cpp">void onPermission ( bool isLogin , const std::string &amp; msg );
</code></pre>

<pre><code class="cpp">void onFetchFriends ( bool ok , const std::string &amp; msg );
</code></pre>

<pre><code class="cpp">void onRequestInvitableFriends ( const FBInvitableFriendsInfo &amp; friends );
</code></pre>

<pre><code class="cpp">void onInviteFriendsWithInviteIdsResult ( bool result ,
                                          const std::string &amp; msg );
</code></pre>

<pre><code class="cpp">void onInviteFriendsResult ( bool result , const std::string &amp; msg );
</code></pre>

<pre><code class="cpp">void onGetUserInfo ( const FBGraphUser &amp; userInfo );
</code></pre>

<pre><code class="cpp">void onRequestGiftResult ( bool result , const std::string &amp; msg ) 
</code></pre>

<pre><code class="cpp">void onSendGiftResult ( bool result , const std::string &amp; msg ) 
</code></pre>

<h2 id="manual-integration">Manual Integration</h2>
<p>If the <em>SDKBOX Installer</em> <strong>fails</strong> to complete successfully, it is possible to integrate SDKBOX manually. If the installer complete successfully, please <strong>do not</strong> complete anymore of this document. It is not necessary.</p>
<p>These steps are listed last in this document on purpose as they are seldom needed. If you find yourself using these steps, please, after completing, double back and re-read the steps above for other integration items.</p>
<h2 id="manual-integration-for-ios">Manual Integration For iOS</h2>
<p>Drag and drop the following frameworks from the <strong>plugins/ios</strong> folder of
the<code>Facebook</code> bundle into your Xcode project, check <code>Copy items if needed</code> when adding frameworks:</p>
<blockquote>
<p>sdkbox.framework</p>
<p>PluginFacebook.framework</p>
</blockquote>
<p>The above frameworks depend upon a large number of other frameworks. You also need to add the following system frameworks, if you don't already have them:</p>
<blockquote>
<p>Security.framework</p>
<p>AdSupport.framework</p>
</blockquote>
<h2 id="manual-integration-for-android">Manual Integration For Android</h2>
<p>SDKBOX supports three different kinds of <strong>Android</strong> projects <strong>command-line</strong>, <strong>eclipse</strong> and <strong>Android Studio</strong>. </p>
<ul>
<li><code>proj.android</code> will be used as our <code>&lt;project_root&gt;</code> for <strong>command-line</strong> and <strong>eclipse</strong> project</li>
<li><code>proj.android-studio</code> will be used as our <code>&lt;project_root&gt;</code> for <strong>Android Studio</strong> project.</li>
</ul>
<h3 id="copy-files">Copy Files</h3>
<p>Copy the following <strong>jar</strong> files from <code>plugin/android/libs</code> folder of this
bundle into your project's <strong><project_root>/libs</strong> folder.</p>
<blockquote>
<p>PluginFacebook.jar</p>
<p>sdkbox.jar</p>
</blockquote>
<ul>
<li>
<p>If you're using cocos2d-x from source copy the <strong>jar</strong> files to:</p>
<p>Android command-line:
<code>cocos2d/cocos/platform/android/java/libs</code></p>
<p>Android Studio:
<pre>
cocos2d/cocos/platform/android/java/libs
cocos2d/cocos/platform/android/libcocos2dx/libs
</pre></p>
</li>
<li>
<p>If you're using cocos2d-js or lua copy the <strong>jar</strong> files to:</p>
<p>Android command-line:
<code>frameworks/cocos2d-x/cocos/platform/android/java/libs</code></p>
<p>Android Studio:
<pre>
frameworks/cocos2d-x/cocos/platform/android/java/libs
frameworks/cocos2d-x/cocos/platform/android/libcocos2dx/libs
</pre></p>
</li>
<li>
<p>If you're using prebuilt cocos2d-x copy the <strong>jar</strong> files to:</p>
<p>Android command-line:
<code>proj.android/libs</code></p>
</li>
</ul>
<p>Copy the <code>facebook_lib</code> directories from <code>plugin/android/libs</code> to your <code>&lt;project_root&gt;/libs/</code> directory.</p>
<h4 id="copy-jni-libs">Copy jni libs</h4>
<p>Copy and overwrite all the folders from <code>plugin/android/jni</code>
to your <code>&lt;project_root&gt;/jni/</code> directory.</p>
<h3 id="edit-androidmanifestxml">Edit <code>AndroidManifest.xml</code></h3>
<p>Include the following permissions above the <strong>application tag</strong>:</p>
<pre><code class="xml">  &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;
</code></pre>

<p>There are also a few necessary meta-data tags that also need to be added:</p>
<pre><code class="xml">&lt;meta-data android:name=&quot;com.facebook.sdk.ApplicationId&quot; android:value=&quot;@string/facebook_app_id&quot;/&gt;
&lt;activity android:name=&quot;com.facebook.FacebookActivity&quot;
  android:configChanges=
         &quot;keyboard|keyboardHidden|screenLayout|screenSize|orientation&quot;
  android:theme=&quot;@android:style/Theme.Translucent.NoTitleBar&quot;
  android:label=&quot;@string/app_name&quot; /&gt;

  &lt;provider android:authorities=&quot;com.facebook.app.FacebookContentProvider__replace_with_your_app_id__&quot;
  android:name=&quot;com.facebook.FacebookContentProvider&quot;
  android:exported=&quot;true&quot; /&gt;
</code></pre>

<h3 id="edit-stringsxml">Edit strings.xml</h3>
<p>Open <code>res/values/strings.xml</code>, Add a new string with the name
<code>facebook_app_id</code> and value as your Facebook App ID. Example:</p>
<pre><code class="xml">  &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
  &lt;resources&gt;
      &lt;string name=&quot;app_name&quot;&gt;facebook&lt;/string&gt;
      &lt;string name=&quot;facebook_app_id&quot;&gt;280194012150923&lt;/string&gt;
  &lt;/resources&gt;
</code></pre>

<h3 id="edit-androidmk">Edit <code>Android.mk</code></h3>
<p>Edit <code>&lt;project_root&gt;/jni/Android.mk</code> to:</p>
<p>Add additional requirements to <strong>LOCAL_WHOLE_STATIC_LIBRARIES</strong>:</p>
<pre><code>LOCAL_WHOLE_STATIC_LIBRARIES += PluginFacebook
LOCAL_WHOLE_STATIC_LIBRARIES += sdkbox
</code></pre>

<p>Add a call to:</p>
<pre><code>$(call import-add-path,$(LOCAL_PATH))
</code></pre>

<p>before any <strong>import-module</strong> statements.</p>
<p>Add additional <strong>import-module</strong> statements at the end:</p>
<pre><code>$(call import-module, ./sdkbox)
$(call import-module, ./pluginfacebook)
</code></pre>

<p>This means that your ordering should look similar to this:</p>
<pre><code>$(call import-add-path,$(LOCAL_PATH))
$(call import-module, ./sdkbox)
$(call import-module, ./pluginfacebook)
</code></pre>

<p><strong>Note:</strong> It is important to make sure these statements are above the existing <code>$(call import-module,./prebuilt-mk)</code> statement, if you are using the pre-built libraries.</p>
<h3 id="modify-applicationmk-cocos2d-x-v30-to-v32-only">Modify <code>Application.mk</code> (Cocos2d-x v3.0 to v3.2 only)</h3>
<p>Edit <code>&lt;project_root&gt;/jni/Application.mk</code> to make sure <strong>APP_STL</strong> is defined
correctly. If <code>Application.mk</code> contains <code>APP_STL := c++_static</code>, it should be
changed to:</p>
<pre><code>APP_STL := gnustl_static
</code></pre>

<h3 id="modify-projectproperties">Modify <code>project.properties</code></h3>
<p>Add following line to your <code>project.properties</code></p>
<pre><code>android.library.reference.1=./libs/facebook_lib
</code></pre>

<blockquote>
<p>Note: if you already have an <code>android.library.reference.1</code> you can add
another by incrementing the final digit as <code>android.library.reference.2</code>, etc.</p>
</blockquote>
<h3 id="modify-appactivityjava">Modify <strong>AppActivity.java</strong></h3>
<h4 id="plugin-2403">Plugin &gt;= 2.4.0.3</h4>
<ol>
<li>Find the <strong>AppActivity.java</strong></li>
</ol>
<pre><code class="bash">find . -name &quot;AppActivity.java&quot;
</code></pre>

<ol>
<li>Replace <code>extends Cocos2dxActivity</code> with <code>extends com.sdkbox.plugin.SDKBoxActivity</code></li>
</ol>
<p>Example of the directory where the <strong>AppActivity.java</strong> file is located:</p>
<pre><code>cpp
  - proj.android/src/org/cocos2dx/cpp/AppActivity.java
  - proj.android-studio/app/src/org/cocos2dx/cpp/AppActivity.java
  - proj.android/app/src/org/cocos2dx/cpp/AppActivity.java ( from cocos2d-x 3.17)

lua
  - frameworks/runtime-src/proj.android/src/org/cocos2dx/lua/AppActivity.java
  - frameworks/runtime-src/proj.android-studio/app/src/org/cocos2dx/lua/AppActivity.java
  - frameworks/runtime-src/proj.android/app/src/org/cocos2dx/lua/AppActivity.java (from cocos2d-x 3.17)

js
  - frameworks/runtime-src/proj.android/src/org/cocos2dx/javascript/AppActivity.java
  - frameworks/runtime-src/proj.android/app/src/org/cocos2dx/javascript/AppActivity.java ( from cocos2d-x 3.17)
</code></pre>

<h4 id="plugin-2403_1">Plugin &lt; 2.4.0.3</h4>
<ul>
<li>
<p>If you're using cocos2d-x from source, assuming you are in the <strong>proj.android</strong> directory, <strong>Cocos2dxActivity.java</strong> is located:</p>
<p><code>../../cocos2d-x/cocos/platform/android/java/src/org/cocos2dx/
lib/Cocos2dxActivity.java</code></p>
</li>
<li>
<p>If you're using the prebuilt cocos2d-x libraries assuming you are in the <code>proj.android</code> directory, <strong>Cocos2dxActivity.java</strong> is located:</p>
<p><code>./src/org/cocos2dx/lib/Cocos2dxActivity.java</code></p>
</li>
</ul>
<p><strong>Note:</strong> When using Cocos2d-x from source, different versions have <strong>Cocos2dxActivity.java</strong> in a different location. One way to find the location is to look in <strong>proj.android/project.properties</strong>. Example:
  <code>android.library.reference.1=../../cocos2d-x/cocos/platform/android/java</code></p>
<p>In this case, <strong>Cocos2dxActivity.java</strong> should be located at:</p>
<pre><code>../../cocos2d-x/cocos/platform/android/java/src/org/cocos2dx/lib/Cocos2dxActivity.java
</code></pre>

<ul>
<li>Modify <strong>Cocos2dxActivity.java</strong> to add the following imports:</li>
</ul>
<pre><code class="java">import android.content.Intent;
import com.sdkbox.plugin.SDKBox;
</code></pre>

<ul>
<li>Second, modify <strong>Cocos2dxActivity.java</strong> to edit the <code>onCreate(final Bundle savedInstanceState)</code> function to add a call to <code>SDKBox.init(this);</code>. The placement of this call is important. It must be done after the call to <code>onLoadNativeLibraries();</code>. Example:</li>
</ul>
<pre><code class="java">onLoadNativeLibraries();
SDKBox.init(this);
</code></pre>

<ul>
<li>
<p>Last, we need to insert the proper <strong>overrides</strong> code. There are a few rules here.</p>
<ul>
<li>
<p>If the method listed has not been defined, <strong>add it</strong>.</p>
</li>
<li>
<p>If the method listed has been defined, add the calls to <code>SDKBox</code> in the <strong>same</strong> existing function.</p>
</li>
</ul>
</li>
</ul>
<pre><code class="java">    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
          if(!SDKBox.onActivityResult(requestCode, resultCode, data)) {
            super.onActivityResult(requestCode, resultCode, data);
          }
    }
    @Override
    protected void onStart() {
          super.onStart();
          SDKBox.onStart();
    }
    @Override
    protected void onStop() {
          super.onStop();
          SDKBox.onStop();
    }
    @Override
    protected void onResume() {
          super.onResume();
          SDKBox.onResume();
    }
    @Override
    protected void onPause() {
          super.onPause();
          SDKBox.onPause();
    }
    @Override
    public void onBackPressed() {
          if(!SDKBox.onBackPressed()) {
            super.onBackPressed();
          }
    }
</code></pre>

<h2 id="proguard-optional">Proguard (optional)</h2>
<ul>
<li>Edit <code>project.properties</code>  to specify a <code>Proguard</code> configuration file. Example:</li>
</ul>
<pre><code>proguard.config=${sdk.dir}/tools/proguard/proguard-android.txt:proguard-project.txt
</code></pre>

<ul>
<li>Edit the file you specified to include the following:</li>
</ul>
<pre><code># facebook
-keep public class com.facebook.** { *; }
-dontwarn com.facebook.**

# cocos2d-x
-keep public class org.cocos2dx.** { *; }
-dontwarn org.cocos2dx.**
-keep public class com.chukong.** { *; }
-dontwarn com.chukong.**

# google play service
-keep public class com.google.android.gms.** { public *; }
-dontwarn com.google.android.gms.**

-keep class com.google.protobuf.** { *; }
-dontwarn com.google.protobuf.**

-keep class * extends java.util.ListResourceBundle {
    protected Object[][] getContents();
}

-keep public class com.google.android.gms.common.internal.safeparcel.SafeParcelable {
    public static final *** NULL;
}

-keepnames @com.google.android.gms.common.annotation.KeepName class *
-keepclassmembernames class * {
    @com.google.android.gms.common.annotation.KeepName *;
}

-keepnames class * implements android.os.Parcelable {
    public static final ** CREATOR;
}

#sdkbox
-keep class com.sdkbox.** { *; }
-dontwarn com.sdkbox.**
</code></pre>

<p><strong>Note:</strong> Proguard only works with <strong>Release</strong> builds (i.e <code>cocos run -m release</code>) debug builds do not invoke Proguard rules.</p>
<h2 id="facebook-compile-issue">Facebook Compile Issue</h2>
<p>now SDKBox include Facebook iOS SDK 7.1.1 static library.</p>
<p>Facebook iOS SDK 7.1.1 static library conflict with <code>Other Linker Flags</code> -&gt; <code>-ObjC</code>.</p>
<p>if you got following error, maybe the reason is conflict.</p>
<pre><code class="html">Could not find or use auto-linked library 'swiftCompatibilityDynamicReplacements'
Could not find or use auto-linked library 'swiftCore'
Could not find or use auto-linked library 'swiftQuartzCore'
Could not find or use auto-linked library 'swiftDispatch'
Could not find or use auto-linked library 'swiftAVFoundation'
Could not find or use auto-linked library 'swiftCoreMedia'
Could not find or use auto-linked library 'swiftCoreAudio'
Could not find or use auto-linked library 'swiftPhotos'
Could not find or use auto-linked library 'swiftCoreMIDI'
Could not find or use auto-linked library 'swiftCoreLocation'
Undefined symbol: protocol descriptor for Foundation._ErrorCodeProtocol
Undefined symbol: associated conformance descriptor for Foundation._ErrorCodeProtocol._ErrorType: Foundation._BridgedStoredNSError
Undefined symbol: base conformance descriptor for Foundation._BridgedStoredNSError: Foundation.CustomNSError
Undefined symbol: base conformance descriptor for Foundation._BridgedStoredNSError: Swift.Hashable
Undefined symbol: base conformance descriptor for Foundation._ErrorCodeProtocol: Swift.Equatable
Undefined symbol: associated conformance descriptor for Foundation._BridgedStoredNSError.Code: Foundation._ErrorCodeProtocol
Undefined symbol: associated conformance descriptor for Foundation._BridgedStoredNSError.Code: Swift.RawRepresentable
Undefined symbol: method descriptor for Foundation._BridgedStoredNSError.init(_nsError: __C.NSError) -&gt; A
Undefined symbol: base conformance descriptor for Foundation.CustomNSError: Swift.Error
Undefined symbol: method descriptor for static Foundation.CustomNSError.errorDomain.getter : Swift.String
Undefined symbol: method descriptor for Foundation._ObjectiveCBridgeableError.init(_bridgedNSError: __shared __C.NSError) -&gt; A?
Undefined symbol: method descriptor for Swift.Error._code.getter : Swift.Int
Undefined symbol: method descriptor for Swift.Error._userInfo.getter : Swift.AnyObject?
Undefined symbol: method descriptor for Swift.Error._getEmbeddedNSError() -&gt; Swift.AnyObject?
Undefined symbol: protocol conformance descriptor for Swift.Int : Swift.FixedWidthInteger in Swift
Undefined symbol: type metadata for Swift.Int
Undefined symbol: protocol descriptor for Foundation.CustomNSError
Undefined symbol: static Swift._DictionaryStorage.allocate(capacity: Swift.Int) -&gt; Swift._DictionaryStorage&lt;A, B&gt;
Undefined symbol: __swiftEmptyDictionarySingleton
</code></pre>

<h3 id="solution-a">solution A</h3>
<ul>
<li>remove <code>Project Setting</code> -&gt; <code>Build Settings</code> -&gt; <code>Linking</code> -&gt; <code>Other Linker Flags</code> -&gt; <code>-ObjC</code> can fix those errors</li>
</ul>
<h3 id="solution-b">solution B</h3>
<ol>
<li>
<p>if your project need <code>-ObjC</code> link flag, then you can use <a href="https://github.com/facebook/facebook-ios-sdk/releases/download/v7.1.1/FacebookSDK_Dynamic.framework.zip">Facebook dynamic library</a></p>
</li>
<li>
<p>unzip and replace Facebook related framework <code>FBSDK*.framework</code>.</p>
</li>
<li>
<p>Change Xcode Setting, <code>Project Setting</code> -&gt; <code>General</code> -&gt; <code>Frameworks, Libraries, and Embedded Content</code> -&gt; <code>FBSDK*.framework</code> -&gt; <code>Embed &amp; Sign</code></p>
</li>
</ol>
<h2 id="facebook-compile-issue_1">Facebook Compile Issue</h2>
<p>if you got following error, </p>
<pre><code class="html">dyld: Library not loaded: @rpath/libswiftCore.dylib
</code></pre>

<p>you can try do like this, <code>Xcode Project</code> -&gt; <code>target</code> -&gt; <code>Build Setting/All</code> -&gt; <code>Always Embed Swift Standard Libraries</code> -&gt; <code>YES</code></p>
<h2 id="facebook-crash-issue">Facebook Crash Issue</h2>
<p>if you got following error,</p>
<pre><code class="html">Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '+[NSError fbErrorFromReturnURLParameters:]: unrecognized selector sent to class 0x1e0bdf480'
</code></pre>

<p>you can do add follow settings to <code>Other Linker Flags</code>:</p>
<pre><code>-ObjC
-force_load
${PROJECT_DIR}/Frameworks/FBSDKLoginKit.framework/FBSDKLoginKit
-force_load
${PROJECT_DIR}/Frameworks/FBSDKCoreKit.framework/FBSDKCoreKit
</code></pre></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Build Date UTC :2021-04-09 03:41:19.777895, Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        
        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script>var base_url = '../../..';</script>
        <script src="../../../js/base.js"></script>
        


        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-70044300-2', 'auto');
            ga('send', 'pageview');
        </script>
        
    </body>
</html>
