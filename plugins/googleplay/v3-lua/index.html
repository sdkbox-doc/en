<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">

	<title>Google Play Services with Lua - SDKBOX</title>
        
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../../css/base.css?2" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">
        <link href="../../../css/custom.css" rel="stylesheet">
        

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="http://sdkbox.com"><img src="http://www.cocos2d-x.org/s/sdkbox/SDKBOX_logo.png">Docs</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">

            <ul class="nav navbar-nav navbar-right">


            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Overview</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cocos2d-x <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../cocos/">Overview</a>
</li>

                        
                            
<li >
    <a href="../../../installer/">CLI Installer</a>
</li>

                        
                            
<li >
    <a href="../../../qa/cocos_creator/">For Cocos Creator</a>
</li>

                        
                            
  
  <li class="dropdown-submenu">
    <a tabindex="-1" class="non-link">Plugins</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../achievement/">Achievements</a>
</li>

        
            
  

        
            
<li >
    <a href="../../adcolony/">AdColony</a>
</li>

        
            
  

        
            
<li >
    <a href="../../admob/">AdMob</a>
</li>

        
            
  

        
            
<li >
    <a href="../../agecheq/">AgeCheq</a>
</li>

        
            
  

        
            
<li >
    <a href="../../appnext/">Appnext</a>
</li>

        
            
  

        
            
<li >
    <a href="../../appodeal/">Appodeal</a>
</li>

        
            
  

        
            
<li >
    <a href="../../amazon/">Amazon</a>
</li>

        
            
  

        
            
<li >
    <a href="../../apteligent/">Apteligent</a>
</li>

        
            
  

        
            
<li >
    <a href="../../bee7/">Bee7</a>
</li>

        
            
  

        
            
<li >
    <a href="../../chartboost/">Chartboost</a>
</li>

        
            
  

        
            
<li >
    <a href="../../ethwallet/">EthWallet</a>
</li>

        
            
<li >
    <a href="../../facebook/">Facebook</a>
</li>

        
            
  

        
            
<li >
    <a href="../../gameroom/">Facebook Gameroom</a>
</li>

        
            
  

        
            
<li >
    <a href="../../firebase/">Firebase</a>
</li>

        
            
  

        
            
<li >
    <a href="../../flurryanalytics/">Flurry Analytics</a>
</li>

        
            
  

        
            
<li >
    <a href="../../fyber/">Fyber</a>
</li>

        
            
  

        
            
<li >
    <a href="../../googleanalytics/">Google Analytics</a>
</li>

        
            
  

        
            
<li >
    <a href="../">Google Play Games</a>
</li>

        
            
  

        
            
<li >
    <a href="../../hms/">Huawei Mobile Services</a>
</li>

        
            
  

        
            
<li >
    <a href="../../iap/">In-App Purchase</a>
</li>

        
            
  

        
            
<li >
    <a href="../../inmobi/">InMobi</a>
</li>

        
            
  

        
            
<li >
    <a href="../../kochava/">Kochava</a>
</li>

        
            
  

        
            
<li >
    <a href="../../leadbolt/">LeadBolt</a>
</li>

        
            
  

        
            
<li >
    <a href="../../leaderboard/">Leaderboard</a>
</li>

        
            
  

        
            
<li >
    <a href="../../misc/">Misc</a>
</li>

        
            
  

        
            
<li >
    <a href="../../onesignal/">OneSignal</a>
</li>

        
            
  

        
            
<li >
    <a href="../../playphone/">Playphone</a>
</li>

        
            
  

        
            
<li >
    <a href="../../phunwareads/">Phunware Ads</a>
</li>

        
            
  

        
            
<li >
    <a href="../../phunwaremessaging/">Phunware Messaging</a>
</li>

        
            
  

        
            
<li >
    <a href="../../review/">Ratings & Reviews</a>
</li>

        
            
  

        
            
<li >
    <a href="../../sdkboxads/">SDKBOX Ads</a>
</li>

        
            
  

        
            
<li >
    <a href="../../sdkboxplay/">SDKBOX Play</a>
</li>

        
            
  

        
            
<li >
    <a href="../../share/">Social Sharing</a>
</li>

        
            
  

        
            
<li >
    <a href="../../signinwithapple/">Sign in with Apple</a>
</li>

        
            
  

        
            
<li >
    <a href="../../tapcore/">Tapcore</a>
</li>

        
            
  

        
            
<li >
    <a href="../../tune/">Tune</a>
</li>

        
            
  

        
            
<li >
    <a href="../../unityads/">UnityAds</a>
</li>

        
            
  

        
            
<li >
    <a href="../../valuepotion/">Valuepotion</a>
</li>

        
            
  

        
            
<li >
    <a href="../../vungle/">Vungle</a>
</li>

        
            
  

        
            
<li >
    <a href="../../youtube/">Youtube</a>
</li>

        
            
  

        
    </ul>
  </li>
  

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Unity <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../unity/allinone/">SDKBOX AllInOne</a>
</li>

                        
                            
<li >
    <a href="../../../unity/iap/">In-App Purchase</a>
</li>

                        
                            
<li >
    <a href="../../../unity/review/">Ratings & Reviews</a>
</li>

                        
                            
<li >
    <a href="../../../unity/socialshare/">SocialShare</a>
</li>

                        
                            
<li >
    <a href="../../../unity/googleanalytics/">Google Analytics</a>
</li>

                        
                            
<li >
    <a href="../../../unity/sdkboxplay/">SDKBOX Play</a>
</li>

                        
                            
<li >
    <a href="../../../unity/addeals/">AdDeals</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Unreal <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../unreal/iap/">In-App Purchase</a>
</li>

                        
                            
<li >
    <a href="../../../unreal/chartboost/">Chartboost</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">LiveOps <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../liveops/">Setup</a>
</li>

                        
                            
<li >
    <a href="../../../liveops/remote-config/">Remote Configuration</a>
</li>

                        
                            
<li >
    <a href="../../../liveops/receipt-verification/">Server-side IAP receipt verification</a>
</li>

                        
                            
<li >
    <a href="../../../liveops/catalog-management/">On-the-fly catalog management</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../qa/install_sdkbox/">Install SDKBox</a>
</li>

                        
                            
<li >
    <a href="../../../qa/from-google-to-amazon/">From Google to Amazon</a>
</li>

                        
                            
<li >
    <a href="../../../qa/integration-admob-to-creator/">Admob in Creator</a>
</li>

                        
                            
<li >
    <a href="../../../qa/integration-fyber-to-cocos/">Fyber with Cocos2d-x</a>
</li>

                        
                            
<li >
    <a href="../../../qa/fb-share-on-cocos/">Facebook with Cocos2d-x</a>
</li>

                        
                            
<li >
    <a href="../../../qa/android_64k/">Fix Android 64K methods limit</a>
</li>

                        
                            
<li >
    <a href="../../../qa/integration-iap-on-unity/">IAP with Unity</a>
</li>

                        
                            
<li >
    <a href="../../../qa/use-gui-integration-ga-to-creator/">GA with SDKBox GUI in Creator</a>
</li>

                        
                            
<li >
    <a href="../../../qa/use-custom-activity-on-unity/">Unity Custom Activity</a>
</li>

                        
                            
<li >
    <a href="../../../qa/crypt-sdkbox-config/">Encrypt Decrypt sdkbox_config.json</a>
</li>

                        
                            
<li >
    <a href="../../../qa/sdkboxplay_troubleshoot/">SDKBoxPlay Troubleshoot</a>
</li>

                        
                            
<li >
    <a href="../../../qa/iap_troubleshoot/">IAP Troubleshoot</a>
</li>

                        
                            
<li >
    <a href="../../../qa/sdkbox-cmake/">CMake</a>
</li>

                        
                            
<li >
    <a href="../../../qa/cmake_xcframework/">CMake With XCFramework</a>
</li>

                        
                            
<li >
    <a href="../../../qa/faq/">FAQ</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../../release-note/">About</a>
                    </li>
                
                

                <li style="margin-left:30px">
                    <a href="http://sdkbox-doc.github.io/zh/">中文</a>
                </li>
                
                </ul>
            




            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#sdk-version">SDK Version</a></li>
	
    
        <li class="main "><a href="#integration">Integration</a></li>
	
    
        <li class="main "><a href="#after-installation">After Installation</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#android">Android</a></li>
        
            <li><a href="#ios">iOS</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#important-notice">Important Notice</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#disable-app-transport-security">Disable App Transport Security</a></li>
        
            <li><a href="#disable-bitcode-support">Disable Bitcode support</a></li>
        
            <li><a href="#set-your-game-requires-full-screen">Set your game requires full screen</a></li>
        
            <li><a href="#whitelist-canopenurl-function">Whitelist canOpenURL function</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#usage">Usage</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#pre-requisites">Pre-requisites</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#initialization">Initialization</a></li>
	
    
        <li class="main "><a href="#callbacks">Callbacks</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#class-method-example">Class method example</a></li>
        
            <li><a href="#lambda-function-example">Lambda function example</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#authorization">Authorization</a></li>
	
    
        <li class="main "><a href="#quests-api">Quests API</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#before-you-begin">Before you begin</a></li>
        
            <li><a href="#submitting-an-event">Submitting an event</a></li>
        
            <li><a href="#retrieving-events">Retrieving events</a></li>
        
            <li><a href="#displaying-quests">Displaying quests</a></li>
        
            <li><a href="#handling-quest-acceptance">Handling quest acceptance</a></li>
        
            <li><a href="#handling-quest-completion">Handling quest completion</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#player-statistics">Player statistics</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#getting-stats-for-the-currently-signed-in-player">Getting stats for the currently signed in player</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#achievements">Achievements</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#state">State</a></li>
        
            <li><a href="#showing-the-ui">Showing the UI</a></li>
        
            <li><a href="#fetch-achievements">Fetch Achievements</a></li>
        
            <li><a href="#fetch-achievement">Fetch Achievement</a></li>
        
            <li><a href="#increment-achievement">Increment Achievement</a></li>
        
            <li><a href="#unlock-achievement">Unlock Achievement</a></li>
        
            <li><a href="#reveal-achievement">Reveal Achievement</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#leaderboards">Leaderboards</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#show-ui">Show UI</a></li>
        
            <li><a href="#showallui">ShowAllUI</a></li>
        
            <li><a href="#submit-score">Submit Score</a></li>
        
            <li><a href="#fetchallscoresummaries">FetchAllScoreSummaries</a></li>
        
            <li><a href="#fetchall">FetchAll</a></li>
        
            <li><a href="#fetchscorepage">FetchScorePage</a></li>
        
            <li><a href="#fetchnextscorepage">FetchNextScorePage</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#realtime-multiplayer">Realtime Multiplayer</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#quick-game">Quick game</a></li>
        
            <li><a href="#invite-players">Invite players</a></li>
        
            <li><a href="#accept-an-invitation">Accept an invitation</a></li>
        
            <li><a href="#the-listener">The listener</a></li>
        
            <li><a href="#sending-messages-to-other-players">Sending messages to other players</a></li>
        
            <li><a href="#leaving-a-room">Leaving a room</a></li>
        
            <li><a href="#accepting-declining-and-dismissing-invitations">Accepting / declining and dismissing invitations</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#turn-based-multiplayer">Turn Based Multiplayer</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#quick-match">Quick Match</a></li>
        
            <li><a href="#choose-players-ui">Choose Players UI</a></li>
        
            <li><a href="#handling-match-events">Handling match events</a></li>
        
            <li><a href="#taking-a-turn">Taking a turn</a></li>
        
            <li><a href="#creating-participant-results">Creating participant results</a></li>
        
            <li><a href="#completing-a-match">Completing a match</a></li>
        
            <li><a href="#leaving-a-match">Leaving a match</a></li>
        
            <li><a href="#cancelling-a-match">Cancelling a match</a></li>
        
            <li><a href="#dismissing-a-match">Dismissing a match</a></li>
        
            <li><a href="#starting-rematch">Starting rematch</a></li>
        
            <li><a href="#fetching-a-previous-match">Fetching a previous match</a></li>
        
            <li><a href="#fetch-all-matches">Fetch all matches</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#nearbyconnections">NearbyConnections</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#init">Init</a></li>
        
            <li><a href="#get-local-endpoint-id">Get local endpoint id</a></li>
        
            <li><a href="#get-local-device-id">Get local device id</a></li>
        
            <li><a href="#advertising">Advertising</a></li>
        
            <li><a href="#stop-advertising">Stop advertising</a></li>
        
            <li><a href="#accept-connect-request">Accept connect request</a></li>
        
            <li><a href="#reject-connect-request">Reject connect request</a></li>
        
            <li><a href="#start-discovery">Start Discovery</a></li>
        
            <li><a href="#stop-discovery">Stop Discovery</a></li>
        
            <li><a href="#send-connect-request">Send Connect Request</a></li>
        
            <li><a href="#send-reliable-message">Send Reliable Message</a></li>
        
            <li><a href="#send-unreliable-message">Send Unreliable Message</a></li>
        
            <li><a href="#disconnect">Disconnect</a></li>
        
            <li><a href="#stop">Stop</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#api-reference">API Reference</a></li>
	
    
        <li class="main "><a href="#callback-result-descriptions">Callback result descriptions</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#result-codes">Result Codes</a></li>
        
            <li><a href="#events">Events</a></li>
        
            <li><a href="#quests">Quests</a></li>
        
            <li><a href="#playerstats">PlayerStats</a></li>
        
            <li><a href="#achievements_1">Achievements</a></li>
        
            <li><a href="#multiplayer">Multiplayer</a></li>
        
            <li><a href="#nearbyconnections_1">NearbyConnections</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#manual-integration">Manual Integration</a></li>
	
    
        <li class="main "><a href="#manual-integration-for-ios">Manual Integration For iOS</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#code-changes">Code changes</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#manual-integration-for-android">Manual Integration For Android</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#copy-files">Copy Files</a></li>
        
            <li><a href="#edit-androidmanifestxml">Edit AndroidManifest.xml</a></li>
        
            <li><a href="#edit-androidmk">Edit Android.mk</a></li>
        
            <li><a href="#modify-applicationmk-cocos2d-x-v30-to-v32-only">Modify Application.mk (Cocos2d-x v3.0 to v3.2 only)</a></li>
        
            <li><a href="#modify-cocos2dxactivityjava">Modify Cocos2dxActivity.java</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#manual-integration-for-google-play-services-sdk-dependent-library-only">Manual Integration for Google Play Services SDK (dependent library only)</a></li>
	
	<ul class="sub-sidenav">
        
            <li><a href="#suggestion">Suggestion</a></li>
        
            <li><a href="#modify-projectproperties">Modify project.properties</a></li>
        
            <li><a href="#integration-manually">Integration manually</a></li>
        
	</ul>
	
    
        <li class="main "><a href="#proguard-optional">Proguard (optional)</a></li>
	
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p><a href="../">&#8249; Google Play Games Services Doc Home</a></p>
<h1>Google Play Games Services Integration Guide</h1>

<h4><em><b>For the Lua version of cocos2d-x v3.x</b> - (<a href="./../">all other versions</a>)</em></h4>

<h2 id="sdk-version">SDK Version</h2>
<ul>
<li>ios: Play Games C++ SDK Version 2.1</li>
<li>android: Google Play Games C++ SDK Version 3.0.1</li>
</ul>
<h2 id="integration">Integration</h2>
<p>Open a terminal and use the following command to install the SDKBOX Google Play Games Services plugin. Make sure you setup the SDKBOX installer correctly.</p>
<pre><code class="bash">$ sdkbox import gpg
</code></pre>

<blockquote>
<p>Warning: Account creation within iOS is no longer supported, please read <a href="https://android-developers.googleblog.com/2016/12/games-authentication-adopting-google.html">this blog post</a> for details</p>
</blockquote>
<h2 id="after-installation">After Installation</h2>
<h3 id="android">Android</h3>
<h4 id="update-androidmanifestxml">Update AndroidManifest.xml</h4>
<p>Add this meta-data tag to your <code>AndroidManifest.xml</code></p>
<pre><code>&lt;meta-data android:name=&quot;com.google.android.gms.games.APP_ID&quot;
    android:value=&quot;@string/google_app_id&quot; /&gt;
</code></pre>

<h4 id="update-stringxml">Update string.xml</h4>
<p>Add this entry to <code>proj.android/res/values/string.xml</code></p>
<pre><code>&lt;string name=&quot;google_app_id&quot;&gt;777734739048&lt;/string&gt;
</code></pre>

<p>Replace <code>google_app_id</code> value with your own App Id.</p>
<h3 id="ios">iOS</h3>
<h4 id="set-a-rootview-controller-for-gpg">Set a rootview controller for GPG:</h4>
<p>Update <code>proj.ios_mac/ios/RootViewController.h</code>
Add this:</p>
<pre><code>#import &lt;GoogleSignIn/GoogleSignIn.h&gt;

// Change RootViewController class definition to:
@interface RootViewController : UIViewController&lt;GIDSignInUIDelegate&gt;
</code></pre>

<h4 id="set-google-play-signin-listeners">Set Google Play signin listeners</h4>
<p>Update <code>proj.ios_mac/ios/AppController.mm</code></p>
<ol>
<li>Add this method:</li>
</ol>
<pre><code>- (BOOL)application:(UIApplication *)app openURL:(NSURL *)url options:(NSDictionary *)options {
    return [[GIDSignIn sharedInstance] handleURL:url
                               sourceApplication:options[UIApplicationOpenURLOptionsSourceApplicationKey]
                                      annotation:options[UIApplicationOpenURLOptionsAnnotationKey]];
}
</code></pre>

<ol>
<li>In this method:</li>
</ol>
<pre><code>(BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
</code></pre>

<p>add a call to (before return YES):</p>
<pre><code>    // _viewController could also be named
    //  viewController, depending of the project type.
    [GIDSignIn sharedInstance].uiDelegate = _viewController;
</code></pre>

<h4 id="add-url-types">Add URL types</h4>
<p>Add the following URL types under <strong>your project &gt; Info &gt; URL Types</strong></p>
<ul>
<li>
<p>URL 1:</p>
<ul>
<li>Identifier: <code>com.google.ReverseClientId</code></li>
<li>Url schemes: <code>com.googleusercontent.apps.777734739048-cdkbeieil19d6pfkavddrri5o19gk4ni</code><blockquote>
<p>(use this as sample, or put your very own application's url scheme)</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>URL 2:</p>
<ul>
<li>Identifier: <code>com.google.BundleId</code></li>
<li>URL schemes: <code>com.sdkbox.gpg</code><blockquote>
<p>(use this as sample or put your own application's bundle id)</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h4 id="further-info">Further info</h4>
<p>For more information check out the <a href="https://developers.google.com/games/services/cpp/gettingStartedIOS">official documentation</a></p>
<h2 id="important-notice">Important Notice</h2>
<p>Please make sure the following settings in your project to make the plugin work well.</p>
<h4 id="disable-app-transport-security">Disable App Transport Security</h4>
<p>Adding the following entry to the <code>info.plist</code> file:</p>
<pre><code>&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;
&lt;dict&gt;
    &lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;
    &lt;true/&gt;
&lt;/dict&gt;
</code></pre>

<p>It should look like this:</p>
<p><img alt="" src="../../../imgs/ATS.png" /></p>
<h4 id="disable-bitcode-support">Disable Bitcode support</h4>
<p>You have to turn off <strong>Bitcode</strong> support. If you don't, cocos2d-x will fail to build.</p>
<h4 id="set-your-game-requires-full-screen">Set your game requires full screen</h4>
<p>If your game doesn't support all screen orientations, you will need to check <code>Requires full screen</code> in Xcode. If you do not, your app will fail Apple's submission process.</p>
<h4 id="whitelist-canopenurl-function">Whitelist canOpenURL function</h4>
<p>This setting depends on what plugins are in your project. You may need to add the required entry to the <code>info.plist</code>, under <code>LSApplicationQueriesSchemes</code>.</p>
<h2 id="usage">Usage</h2>
<h3 id="pre-requisites">Pre-requisites</h3>
<p>Your must create your app on <a href="https://play.google.com/apps/publish">Google Play Developer console</a> and all the services must be explicitly enabled and configured in the console.</p>
<ul>
<li>Please follow <a href="https://developers.google.com/games/services/console/enabling">setup guide</a> to setup Google Play Games Services for your game.</li>
<li>After the setup, please follow <a href="https://developers.google.com/games/services/console/configuring">config guide</a> to enable different Games Services for your game.</li>
</ul>
<blockquote>
<p>Note: Google Play Games Services will use your release keystore by default, if you want to test your game in debug settings, please link an additional app with <a href="http://stackoverflow.com/questions/17612928/should-i-use-debug-keystore-with-google-play-game-services-during-development">debug keystore</a></p>
</blockquote>
<h2 id="initialization">Initialization</h2>
<p>Currently the configuration process is done in Lua and passed into Google Play Services when creating the game services object. This object is managed for you, and is available from the <code>gpg</code> Lua namespace.</p>
<p>To create the game services instance, you need to pass in a table that contains the <code>ClientID</code> that represents the game you have created in the Google Play Console.</p>
<pre><code>    local config = {ClientID=&quot;...&quot;}
    gpg:CreateGameServices(config)
</code></pre>

<p>Note that the <code>ClientID</code> used is the forwards version from the Google Play Console. There is also a reversed version that is used in the plist. Make sure that you have the correct version, else the initialization will fail.</p>
<p>The full list of configuration data that can be passed is as follows.</p>
<pre><code>{
    LogLevel        = 1 or 2,
    EnableSnapshots = true or false,
    ClientID        = forwards client id
}
</code></pre>

<h2 id="callbacks">Callbacks</h2>
<p>Most of the Google Play Services methods take a callback argument to return the results. This is mainly because the methods are performed asynchronously, and the results may only be available in the future.</p>
<p>Two types of callbacks are supported. Class method callbacks, and function callbacks (which includes lambda functions)</p>
<h3 id="class-method-example">Class method example</h3>
<pre><code>ExampleClass:CallbackMethod(result)
    -- use result here
end

local someClass = ExampleClass:new()

gpg:MethodWithCallback({someClass, ExampleClass.CallbackMethod})
</code></pre>

<p>Notice that in the class method example, you must pass in the instance of the class as well as the method.</p>
<h3 id="lambda-function-example">Lambda function example</h3>
<pre><code>gpg:MethodWithCallback(function(result)
    -- use result here
end)
</code></pre>

<h2 id="authorization">Authorization</h2>
<p>Before you can do anything with Google Play Services, you must authenticate. If you have previously authenticated, then sdkbox will attempt to log you in automatically. You will still get the same events that you normally would if you are logged in automatically.</p>
<p>To begin the authentication process, you call the following, and pass in either a class method or a lambda method (see Callbacks) to receive the response.</p>
<pre><code>gpg:StartAuthorizationUI(function(result)
    if result.authStatus == gpg.AuthStatus.VALID then
        -- successfully authenticated
    end
end)
</code></pre>

<h2 id="quests-api">Quests API</h2>
<h3 id="before-you-begin">Before you begin</h3>
<p>Make sure to checkout the Google Play Services Quests <a href="https://developers.google.com/games/services/common/concepts/quests">documentation</a> in order to better understand how to setup quests using their portal, and for a reference on the API.</p>
<p>Before your game can access events and quests, you must define them first in the <a href="https://play.google.com/apps/publish/">Google Play Developer Console</a></p>
<h3 id="submitting-an-event">Submitting an event</h3>
<p>You send events to the Events service in order to let it know that something has happened. There is no result to this method, so no callback is needed.</p>
<pre><code>gpg.Events:Increment(&quot;&lt;event id&gt;&quot;)
</code></pre>

<h3 id="retrieving-events">Retrieving events</h3>
<p>To retrieve the current count of events, use one of the <em>Fetch</em> methods.</p>
<pre><code>gpg.Events:Fetch(&quot;&lt;event id&gt;&quot;, function(result)
    -- use result.count here
end)

-- or

gpg.Events:FetchAll(function(results)
    for k,v in pairs(results.data) do
        -- k is the event id
        -- use v.count here
    end
end)
</code></pre>

<p>The complete list of members to callback results can be found in the callback result descriptions section at the end of this documentation.</p>
<h3 id="displaying-quests">Displaying quests</h3>
<p>Google Play Services provides a UI to select quests, or you can provide your own using the quest data from callbacks.</p>
<p>To use the one provided, you can either display all available quests, or just a single quest UI.</p>
<pre><code>gpg.Quests:ShowUI(&quot;&lt;quest id&gt;&quot;, function(result)
    -- use result.quest here
end)

-- or

gpg.Quests:ShowAllUI(function(result)
    -- use result.quest here
end)
</code></pre>

<h3 id="handling-quest-acceptance">Handling quest acceptance</h3>
<p>If your game uses the built-in quest UI, then the callback result will have a valid Quest object, which you can test using <code>quest.valid()</code> otherwise if you are using your own UI, then you can call accept as follows.</p>
<pre><code>gpg.Quests:Accept(&quot;&lt;quest id&gt;&quot;, function(result)
    -- use result.quest here
end)
</code></pre>

<h3 id="handling-quest-completion">Handling quest completion</h3>
<p>After players accept a quest, you send events to the quest service to inform it of progress on the quest.</p>
<p>One all the criteria for the quest have been satisfied, you can claim the reward  in the built-in UI or your own.</p>
<p>You claim a quest milestone by calling the claim method.</p>
<pre><code>gpg.Quests:ClaimMilestone(&quot;&lt;milestone id&gt;&quot;, function(result)
    if result.status == gpg.ClaimMilestoneResponse.VALID
        -- use result.milestone.completionRewardData here
    end
end)
</code></pre>

<h2 id="player-statistics">Player statistics</h2>
<p>For a complete description of what player statistics are, and how to use them, please refer to the Google Play Services section on the topic <a href="https://developers.google.com/games/services/cpp/stats">here</a></p>
<h3 id="getting-stats-for-the-currently-signed-in-player">Getting stats for the currently signed in player</h3>
<p>You can fetch stats for the current player like this.</p>
<pre><code>gpg.Stats:FetchForPlayer(function(result)
    if result.status == gpg.FetchForPlayerResponse.VALID then
        -- use PlayerStats here
    end
end)
</code></pre>

<h2 id="achievements">Achievements</h2>
<p>For the complete documentation, check out <a href="https://developers.google.com/games/services/common/concepts/achievements">achievements</a></p>
<h3 id="state">State</h3>
<p>Achievements can be hidden, revealed, and unlocked.</p>
<p>Achievements can be designated as standard or incremental. Generally, an incremental achievement involves a player making gradual progress towards earning the achievement over a longer period of time</p>
<h3 id="showing-the-ui">Showing the UI</h3>
<pre><code>    gpg.Achievements:ShowAllUI(function(result)
        -- handle the result here
    end)
</code></pre>

<h3 id="fetch-achievements">Fetch Achievements</h3>
<pre><code>    gpg.Achievements:FetchAll(nil, function(result)
        log:d(log:to_str(result))
    end)
</code></pre>

<h3 id="fetch-achievement">Fetch Achievement</h3>
<pre><code>    gpg.Achievements:Fetch('CgkI6KjppNEWEAIQBQ', nil, function(result)
        log:d(log:to_str(result))
    end)
</code></pre>

<h3 id="increment-achievement">Increment Achievement</h3>
<pre><code>   gpg.Achievements:Increment('CgkI6KjppNEWEAIQBQ')
</code></pre>

<h3 id="unlock-achievement">Unlock Achievement</h3>
<pre><code>   gpg.Achievements:Unlock('CgkI6KjppNEWEAIQBQ')
</code></pre>

<h3 id="reveal-achievement">Reveal Achievement</h3>
<pre><code>    gpg.Achievements:Reveal('CgkI6KjppNEWEAIQBQ')
</code></pre>

<h2 id="leaderboards">Leaderboards</h2>
<p>Checkout additional docs for leaderboards <a href="https://developers.google.com/games/services/common/concepts/leaderboards">here</a></p>
<h3 id="show-ui">Show UI</h3>
<pre><code>    gpg.Leaderboards:ShowUI(&quot;achievement id&quot;)
</code></pre>

<h3 id="showallui">ShowAllUI</h3>
<pre><code>    gpg.Leaderboards:ShowAllUI()
</code></pre>

<h3 id="submit-score">Submit Score</h3>
<pre><code>    gpg.Leaderboards:SubmitScore(&quot;achievement id&quot;, score, &quot;meta data&quot;, function(result)
    end)
</code></pre>

<h3 id="fetchallscoresummaries">FetchAllScoreSummaries</h3>
<pre><code>    gpg.Leaderboards:FetchAllScoreSummaries(&quot;achievement id&quot;, data source, function(result)
    end)
</code></pre>

<h3 id="fetchall">FetchAll</h3>
<pre><code>    gpg.Leaderboards:FetchAll(datasource, function(result)
    end)
</code></pre>

<h3 id="fetchscorepage">FetchScorePage</h3>
<pre><code>    gpg.Leaderboards:FetchScorePage(&quot;achievement id&quot;, datasource, time, timespan, collection, maxitmes, function(result)
    end)
</code></pre>

<h3 id="fetchnextscorepage">FetchNextScorePage</h3>
<pre><code>    gpg.Leaderboards:FetchNextScorePage(datasource, max items, function(result)
    end)
</code></pre>

<h2 id="realtime-multiplayer">Realtime Multiplayer</h2>
<p>Before you begin, familiarize yourself with the Google Play Games real time multiplayer game concepts <a href="https://developers.google.com/games/services/common/concepts/realtimeMultiplayer">here</a>.</p>
<p>In order to use real time multiplayer, you must <a href="https://developers.google.com/games/services/cpp/realtimeMultiplayer">enable</a> it in the Google Play Developer Console.</p>
<p>To begin a real time multiplayer game, there are three ways to connect with other players to start a real time multiplayer games.</p>
<h3 id="quick-game">Quick game</h3>
<p>Lets the player play against randomly selected opponents (via auto-matching).</p>
<pre><code>    gpg.Realtime:CreateRealTimeRoom(
        {
            type = &quot;quick_match&quot;, -- select automatching
            quick_match_params = 
            {
                maximumAutomatchingPlayers = 1,
                minimumAutomatchingPlayers = 1
            }
        },
        listener, 
        function(result)
            if (gpg:IsSuccess(result.result)) then
                -- use result.room here
            end    
        end
    )
</code></pre>

<h3 id="invite-players">Invite players</h3>
<p>This lets you choose specific players to invite.</p>
<pre><code>    gpg.Realtime:CreateRealTimeRoom(
        {
            type = &quot;ui&quot;, -- select invite players UI
            ui_params = 
            {
                maximumPlayers = 1,
                minimumPlayers = 1
            }
        },
        listener, 
        function(result)
            if (gpg:IsSuccess(result.result)) then
                -- use result.room here
            end           
        end
    )
</code></pre>

<h3 id="accept-an-invitation">Accept an invitation</h3>
<p>In the case of choosing specific players, you will receive and invitation that you can either accept or decline.</p>
<pre><code>    -- you can fetch all pending invitations like this
    -- this will call you back with a result and array of invitations
    gpg.Realtime:FetchInvitations(function(result)
        if (gpg:IsSuccess(result.result)) then
            -- do something with result.invitations
        end
    end)

    -- or you can use the UI to accept or decline an invitation
    gpg.Realtime:ShowRoomInboxUI(function(result)
        if (gpg:IsSuccess(result.result)) then
            -- do something with result.invitation
        end
    end)
</code></pre>

<h3 id="the-listener">The listener</h3>
<p>The room creation methods, including accepting an invitation, take a listener object. This is so that when things happen in the room, the listener can be informed.</p>
<p>This is also where you will receive data messages from other players, via the <code>onDataReceived</code> callback method.</p>
<pre><code>listener = 
{
    -- called when something about the room changes
    onRoomStatusChanged = function(room)
    end,

    -- called when something about the connection changes
    onConnectedSetChanged = function(room)
    end,

    -- called when you get connected
    onP2PConnected = function(room, participant) 
    end,

    -- called when you get disconnected
    onP2PDisconnected = function(room, participant) 
    end,

    -- called if the status of one of the room participants changes
    onParticipantStatusChanged = function(room, participant) 
    end,

    -- called whenever someone sends you a message
    onDataReceived = function(room, from_participant, data, is_reliable) 
    end
}
</code></pre>

<h3 id="sending-messages-to-other-players">Sending messages to other players</h3>
<p>There are two types of messages you can send, reliable and unreliable. 
Reliable messages are guaranteed, and will automatically resend if they get lost. 
There is some overhead to this, so if you don't need reliability, then you can send an unreliable message which is a little more efficient at the cost of reliability.</p>
<pre><code>gpg.Realtime:SendReliableMessage(room_id, participant_id, message, function(result)
    if (gpg:IsSuccess(result.result)) then
        -- message send was successful
    end
end)
</code></pre>

<p>Sending an unreliable message takes a json encoded string for the parameters.
There is no callback, since being unreliable, there is no return status.</p>
<pre><code>gpg.Realtime:SendUnreliableMessage(json.encode({
    data = message,
    room_id = room_id
    participant_ids = {}
}))
</code></pre>

<h3 id="leaving-a-room">Leaving a room</h3>
<pre><code>gpg.Realtime:LeaveRoom(room_id, function(result)
end)
</code></pre>

<h3 id="accepting-declining-and-dismissing-invitations">Accepting / declining and dismissing invitations</h3>
<p>For accepting invitations, you must provide a listener that will handle all the events for the room you are joining.</p>
<pre><code>gpg.Realtime:AcceptInvitation(invitation_id, listener, function(result)
end)
</code></pre>

<p>Decline and Dismiss do not take callbacks, they just inform the server that you are no longer interested in the invitation.
Dismissing an invitation is for when the game is over, but the invitation is still in your inbox.</p>
<pre><code>gpg.Realtime:DeclineInvitation(invitation_id)
</code></pre>

<pre><code>gpg.Realtime:DismissInvitation(invitation_id)
</code></pre>

<h2 id="turn-based-multiplayer">Turn Based Multiplayer</h2>
<p>Before you begin make sure to checkout Google's documentation <a href="https://developers.google.com/games/services/cpp/turnbasedMultiplayer">here</a> and also checkout the turn based multiplayer game concepts <a href="https://developers.google.com/games/services/common/concepts/turnbasedMultiplayer">here</a></p>
<p>To start a turn based multiplayer game, there are two ways to do so. You can either use a UI to select players (either Google's or your own), or you can start a quick match which will choose players for you.</p>
<h3 id="quick-match">Quick Match</h3>
<pre><code>local minimumPlayers = 1
local maximumPlayers = 2
local allowAutoMatching = false
gpg.Turnbased:ShowPlayerSelectUI(minimumPlayers, maximumPlayers, allowAutoMatching, function(result)
    params = {
        type = &quot;quick_match&quot;,
        minimumAutomatchingPlayers = result.minimumAutomatchingPlayers,
        maximumAutomatchingPlayers = result.maximumAutomatchingPlayers,
        playerIds = result.playerIds
    }
    gpg.Turnbased:CreateTurnBasedMatch(params, function(result)
        if gpg:IsSuccess(result.result) then
            -- use result.match to start playing
        end
    end)
end)
</code></pre>

<h3 id="choose-players-ui">Choose Players UI</h3>
<pre><code>params = {
    type = &quot;ui&quot;,
    minimumAutomatchingPlayers = 1,
    maximumAutomatchingPlayers = 2
}
gpg.Turnbased:CreateTurnBasedMatch(params, function(result)
    if gpg:IsSuccess(result.result) then
        -- use result.match to start playing
    end
end)
</code></pre>

<h3 id="handling-match-events">Handling match events</h3>
<p>There are two events that need to be handled for turn based multiplayer. You can register for two callbacks (see Callbacks) in order to handle these events.</p>
<pre><code>gpg.Turnbased:addMatchEventCallback(
    gpg.DefaultCallbacks.TURN_BASED_MATCH_EVENT, 
    function(event) 
        gpg.Turnbased:ShowMatchInboxUI(function(result)
            if gpg:IsSuccess(result.result) then
                -- start using result.match here
            end
        end)    
    end
)

-- or

gpg.Turnbased:addMatchEventCallback(
    gpg.DefaultCallbacks.MULTIPLAYER_INVITATION_EVENT, 
    {instance, method}
)

function class:method()
    gpg.Turnbased:ShowMatchInboxUI(function(result)
        if gpg:IsSuccess(result.result) then
            local match = result.match
            if match.matchStatus == gpg.MatchStatus.MY_TURN then
                -- do something with match, take a turn
            elseif match.matchStatus == gpg.MatchStatus.THEIR_TURN then
                -- update for their turn
            elseif match.matchStatus == gpg.MatchStatus.COMPLETED then
                -- complete match, dismiss
            else match.matchStatus == gpg.MatchStatus.EXPIRED then
                -- dismiss 
            end
        end
    end)
end
</code></pre>

<h3 id="taking-a-turn">Taking a turn</h3>
<p>To take a turn, you must update the match data with your turn data, and pass it to the next participant. You can use the id "AUTOMATCHING_PARTICIPANT" if you would like the next participant to be automatched.</p>
<pre><code>local results = match.participantResults
if winnig then
    results = gpg.Turnbased:createParticipantResult(match_id, match.pendingParticipant.id, my_rank, win_token)
elseif losing then
    results = gpg.Turnbased:createParticipantResult(match.id, match.pendingParticipant.id, my_rank, lose_token)
end

local nextParticipant = &quot;AUTOMATCHING_PARTICIPANT&quot;
if match.suggestedNextParticipant.valid and 
   match.suggestedNextParticipant.id ~= &quot;&quot; then
    nextParticipant = match.suggestedNextParticipant.id
end
gpg.Turnbased:TakeMyTurn(match_id, match.pendingParticipant.id, nextParticipant, data, function(result)
end)    
</code></pre>

<h3 id="creating-participant-results">Creating participant results</h3>
<p>Sometimes you need to pass participant results to a method. In c++ this is done directly using a struct, but in Lua you need to use an id. This id is used to lookup the struct and pass it for you. You can reuse existing participant ids or just create your own. The method will also return the struct as a Lua object.</p>
<pre><code>local results = gpg.Turnbased:CreateParticipantResult(match_id, participant_id, placement, match_result)
-- use results, or call method and pass participant_id
</code></pre>

<h3 id="completing-a-match">Completing a match</h3>
<pre><code>gpg.Turnbased:FinishMatchDuringMyTurn(match_id, participant_results_id, data, function(result)
    if gpg:IsSuccess(result.result) then
        -- success
    end
end)
</code></pre>

<h3 id="leaving-a-match">Leaving a match</h3>
<p>You can leave a match at any time, but you need to call the right method, either of the following.</p>
<pre><code>gpg.Turnbased:LeaveMatchDuringMyTurn(match_id, next_participant_id, function(result)
    if gpg:IsSuccess(result.result) then
        -- success
    end 
end)

-- or

gpg.Turnbased:LeaveMatchDuringTheirTurn(match_id, function(result)
    if gpg:IsSuccess(result.result) then
        -- success
    end
end)
</code></pre>

<h3 id="cancelling-a-match">Cancelling a match</h3>
<pre><code>gpg.Turnbased:CancelMatch(match_id, function(result)
    if gpg:IsSuccess(result.result) then
        -- success
    end
end)
</code></pre>

<h3 id="dismissing-a-match">Dismissing a match</h3>
<pre><code>gpg.Turnbased:CancelMatch(match_id)
</code></pre>

<h3 id="starting-rematch">Starting rematch</h3>
<pre><code>gpg.Turnbased:Rematch(match_id, function(result)
    if gpg:IsSuccess(result.result) then
        -- success
    end
end)
</code></pre>

<h3 id="fetching-a-previous-match">Fetching a previous match</h3>
<pre><code>gpg.Turnbased:FetchMatch(match_id, function(result)
    if gpg:IsSuccess(result.result) then
        -- success
    end
end)
</code></pre>

<h3 id="fetch-all-matches">Fetch all matches</h3>
<pre><code>gpg.Turnbased:FetchMatches(function(result)
    if gpg:IsSuccess(result.result) then
        -- use result.matches here
    end
end)
</code></pre>

<h2 id="nearbyconnections">NearbyConnections</h2>
<p>For the complete documentation, check out <a href="https://developers.google.com/games/services/cpp/nearby">Nearby Connections</a></p>
<h3 id="init">Init</h3>
<p>init nearby connection, if not support current platform, will return false</p>
<pre><code class="lua">local support = gpg.NearbyConnections:Init(&quot;{\&quot;LogLevel\&quot;:1}&quot;,
    function(result)
        if result.InitializationStatus then
            print('GPG Nearby init success')
        else
            print('GPG Nearby init failed')
        end
    end)
if not support then
    print('GPG Nearby is not support ios')
end
</code></pre>

<h3 id="get-local-endpoint-id">Get local endpoint id</h3>
<p>get local endpoint id when connect success</p>
<pre><code class="lua">local endpoint = gpg.NearbyConnections:GetLocalEndpointId();
print('Local Endpoint Id:' .. endpoint)
</code></pre>

<h3 id="get-local-device-id">Get local device id</h3>
<pre><code class="lua">local deviceid = gpg.NearbyConnections:GetLocalDeviceId();
print('Local device id:' .. deviceid)
</code></pre>

<h3 id="advertising">Advertising</h3>
<p>start advertising</p>
<pre><code class="lua">gpg.NearbyConnections:StartAdvertising(
    &quot;\&quot;name\&quot;:\&quot;\&quot;,\&quot;duration\&quot;:0,\&quot;app_identifiers\&quot;:{\&quot;identifier\&quot;:\&quot;com.sdkbox.gpg\&quot;},&quot;,
    function(result)
        -- start advertising result

        if (1 == result.start_advertising_result.status) then
            print(&quot;GPG start advertising result:&quot; .. result.client_id
                .. &quot; status:&quot; .. result.start_advertising_result.status
                .. &quot; local_endpoint_name:&quot; .. result.start_advertising_result.local_endpoint_name)
        else
            print('start advertising failed:' .. result.start_advertising_result.status)
        end
    end,
    function(result)
        --request connect callback

        local remote_endpoint_id = result.request.remote_endpoint_id
        local payload = result.request.payload

        log:d('GPG receive connect request:' .. remote_endpoint_id)

        -- auto accept or query user
        -- 1. accept connect request
        -- invoke AcceptConnectionRequest
        -- gpg.NearbyConnections:AcceptConnectionRequest(remote_endpoint_id, payload, function (result) end)

        -- 2. reject connect request
        -- invoke RejectConnectionRequest
    end)
</code></pre>

<h3 id="stop-advertising">Stop advertising</h3>
<pre><code class="lua">gpg.NearbyConnections:StopAdvertising()
</code></pre>

<h3 id="accept-connect-request">Accept connect request</h3>
<pre><code class="lua">gpg.NearbyConnections:AcceptConnectionRequest(
    remote_endpoint_id,
    payload,
    function (result)
        print('event:' .. result.event)
        if 'OnMessageReceived' == result.event then
            print('OnMessageReceived client_id:' .. tostring(result.client_id)
                .. ' remote_endpoint_id:' .. tostring(result.remote_endpoint_id)
                .. ' payload:' .. tostring(result.payload)
                .. ' is_reliable:' .. tostring(result.is_reliable))
        elseif 'OnDisconnected' == result.event then
            print('OnDisconnected client_id:' .. tostring(result.client_id)
                .. ' remote_endpoint_id:' .. tostring(result.remote_endpoint_id))
        else
            print('Unknown event:' .. result.event);
        end
    end)

</code></pre>

<h3 id="reject-connect-request">Reject connect request</h3>
<pre><code class="lua">gpg.NearbyConnections:RejectConnectionRequest(remote_endpoint_id)
</code></pre>

<h3 id="start-discovery">Start Discovery</h3>
<p>duration in milliseconds</p>
<pre><code class="lua">gpg.NearbyConnections:StartDiscovery(server_id, duration,
    function (result)
        if 'OnEndpointFound' == result.event then
            print('found client_id:' .. tostring(result.client_id)
                .. ' endpoint_id:' .. tostring(result.endpoint_details.endpoint_id)
                .. ' device_id:' .. tostring(result.endpoint_details.device_id)
                .. ' name:' .. tostring(result.endpoint_details.name)
                .. ' service_id:' .. tostring(result.endpoint_details.server_id))
        elseif 'OnEndpointLost' == result.event then
            print('endpoint lost')
        else
            print('unknown event')
        end
    end)
</code></pre>

<h3 id="stop-discovery">Stop Discovery</h3>
<pre><code class="lua">gpg.NearbyConnections:StopDiscovery()
</code></pre>

<h3 id="send-connect-request">Send Connect Request</h3>
<pre><code class="lua">gpg.NearbyConnections:SendConnectionRequest(
    name, remote_endpoint_id, payload,
    function(result)
        -- connect response callback
        if (1 == result.response.status) then
            print('Connect advertising success');
            local remote_endpoint_id = result.response.remote_endpoint_id;
        else
            print('Connect advertising failed');
        end
    end,
    function(result)
        if 'OnMessageReceived' == result.event then
            print('OnMessageReceived client_id:' .. tostring(result.client_id)
                .. ' remote_endpoint_id:' .. tostring(result.remote_endpoint_id)
                .. ' payload:' .. tostring(result.payload)
                .. ' is_reliable:' .. tostring(result.is_reliable))
        elseif 'OnDisconnected' == result.event then
            print('OnDisconnected client_id:' .. tostring(result.client_id)
                .. ' remote_endpoint_id:' .. tostring(result.remote_endpoint_id))
        else
            print('Unknown event:' .. result.event);
        end
    end)
</code></pre>

<h3 id="send-reliable-message">Send Reliable Message</h3>
<pre><code class="lua">gpg.NearbyConnections:SendReliableMessage(remote_endpoint_id1, message)
gpg.NearbyConnections:SendReliableMessage([remote_endpoint_id1, remote_endpoint_id2], message);
</code></pre>

<h3 id="send-unreliable-message">Send Unreliable Message</h3>
<pre><code class="lua">gpg.NearbyConnections:SendUnreliableMessage(remote_endpoint_id1, message)
gpg.NearbyConnections:SendUnreliableMessage([remote_endpoint_id1, remote_endpoint_id2], message);
</code></pre>

<h3 id="disconnect">Disconnect</h3>
<pre><code class="lua">gpg.NearbyConnections:Disconnect(remote_endpoint_id)
</code></pre>

<h3 id="stop">Stop</h3>
<pre><code class="lua">gpg.NearbyConnections:Stop()
</code></pre>

<h2 id="api-reference">API Reference</h2>
<h2 id="callback-result-descriptions">Callback result descriptions</h2>
<h3 id="result-codes">Result Codes</h3>
<pre><code>{
    VALID                           = 1,
    VALID_BUT_STALE                 = 2,
    VALID_WITH_CONFLICT             = 3,
    FLUSHED                         = 4,
    ERROR_LICENSE_CHECK_FAILED      = -1,
    ERROR_INTERNAL                  = -2,
    ERROR_NOT_AUTHORIZED            = -3,
    ERROR_VERSION_UPDATE_REQUIRED   = -4,
    ERROR_TIMEOUT                   = -5,
    ERROR_CANCELED                  = -6,
    ERROR_MATCH_ALREADY_REMATCHED   = -7,
    ERROR_INACTIVE_MATCH            = -8,
    ERROR_INVALID_RESULTS           = -9,
    ERROR_INVALID_MATCH             = -10,
    ERROR_MATCH_OUT_OF_DATE         = -11,
    ERROR_UI_BUSY                   = -12,
    ERROR_QUEST_NO_LONGER_AVAILABLE = -13,
    ERROR_QUEST_NOT_STARTED         = -14,
    ERROR_MILESTONE_ALREADY_CLAIMED = -15,
    ERROR_MILESTONE_CLAIM_FAILED    = -16,
    ERROR_REAL_TIME_ROOM_NOT_JOINED = -17,
    ERROR_LEFT_ROOM                 = -18
}
</code></pre>

<h3 id="events">Events</h3>
<h4 id="event-description">Event description</h4>
<pre><code>{
    &quot;valid&quot;       : 1 or 0
    &quot;id&quot;          : event id,
    &quot;name&quot;        : event name,
    &quot;description&quot; : event description text,
    &quot;visibility&quot;  : whether or not event can be seen,
    &quot;count&quot;       : current count of events of this type,
    &quot;imageUrl&quot;    : URL to the event image
}
</code></pre>

<h4 id="eventsfetchall">Events:FetchAll</h4>
<pre><code>{
    &quot;status&quot; : 1 or 0 indication success or failure,
    &quot;data&quot;   : {
        event_id : Event,
        ...
    }
}
</code></pre>

<h4 id="eventsfetch">Events:Fetch</h4>
<pre><code>{
    &quot;result&quot; : 1 or 0,
    &quot;event&quot;  : Event
}
</code></pre>

<h3 id="quests">Quests</h3>
<h4 id="quest-description">Quest description</h4>
<pre><code>{
    &quot;valid&quot;            : 1 or 0,
    &quot;id&quot;               : quest id,
    &quot;name&quot;             : name of quest,
    &quot;description&quot;      : text description of quest,
    &quot;iconUrl&quot;          : URL to quest icon,
    &quot;bannerUrl&quot;        : URL to quest banner image,
    &quot;currentMilestone&quot; : QuestMileStone,
    &quot;questState&quot;       : quest state, accepted or not,
    &quot;startTime&quot;        : time the quest starts,
    &quot;expirationTime&quot;   : time the quest expires,
    &quot;acceptedTime&quot;     : time that the quest was accepted
}
</code></pre>

<h4 id="questmilestone-description">QuestMilestone description</h4>
<pre><code>{
    &quot;valid&quot;                : 1 or 0,
    &quot;id&quot;                   : milestone id,
    &quot;questId&quot;              : quest id for this milestone,
    &quot;eventId&quot;              : event id,
    &quot;state&quot;                : milestone state,
    &quot;currentCount&quot;         : current count,
    &quot;targetCount&quot;          : count to complete milestone,
    &quot;completionRewardData&quot; : string containing reward data from console
}
</code></pre>

<h4 id="questsfetch">Quests:Fetch</h4>
<pre><code>{
    &quot;result&quot; : 1 or 0,
    &quot;quest&quot;  : Quest
}
</code></pre>

<h4 id="questsfetchlist">Quests:FetchList</h4>
<pre><code>{
    &quot;status&quot; : 1 or 0,
    &quot;data    : 1 based array of Quest
}
</code></pre>

<h4 id="questsaccept">Quests:Accept</h4>
<pre><code>{
    &quot;status&quot; : 1 or 0,
    &quot;quest&quot;  : Quest
}
</code></pre>

<h4 id="questsclaimmilestone">Quests:ClaimMilestone</h4>
<pre><code>{
    &quot;status&quot;    : 1 or 0,
    &quot;milestone&quot; : QuestMilestone
    &quot;quest&quot;     : Quest
}
</code></pre>

<h4 id="questsshowui">Quests:ShowUI</h4>
<pre><code>{
    &quot;status&quot; : 1 or 0,
    &quot;result&quot; : 1 or 0,
    &quot;quest&quot;  : Quest
}
</code></pre>

<h4 id="questsshowallui">Quests:ShowAllUI</h4>
<pre><code>{
    &quot;status&quot; : 1 or 0,
    &quot;result&quot; : 1 or 0,
    &quot;quest&quot;  : Quest
}
</code></pre>

<h3 id="playerstats">PlayerStats</h3>
<h4 id="playerstats-description">PlayerStats description</h4>
<pre><code>{
    &quot;valid&quot;                   : 1 or 0,
    &quot;hasAverageSessionLength&quot; : 1 if valid,
    &quot;averageSessionLength&quot;    : length of session in ?,
    &quot;hasChurnProbability&quot;     : 1 if valid,
    &quot;churnProbability&quot;        : 0 - 1 likelihood of retention,
    &quot;hasDaysSinceLastPlayed&quot;  : 1 if valid,
    &quot;daysSinceLastPlayed&quot;     : count of days,
    &quot;hasNumberOfPurchases&quot;    : 1 if valid,
    &quot;numberOfPurchases&quot;       : total number of purchases,
    &quot;hasNumberOfSessions&quot;     : 1 if valid,
    &quot;numberOfSessions&quot;        : number of sessions played,
    &quot;hasSessionPercentile&quot;    : 1 if valid,
    &quot;sessionPercentile&quot;       : what percentile they are in,
    &quot;hasSpendPercentile&quot;      : 1 if valid,
    &quot;spendPercentile&quot;         : what spend percentile they are in
}
</code></pre>

<h3 id="achievements_1">Achievements</h3>
<h4 id="achievement-description">Achievement description</h4>
<pre><code>{
    &quot;currentSteps&quot;     : Current steps completed of the achievement,
    &quot;description&quot;      : Description of the achievement.
    &quot;id&quot;               : String Id,
    &quot;lastModifiedTime&quot; : Time last modified,
    &quot;name&quot;             : Name of the achievement,
    &quot;revealedIconUrl&quot;  : URL for the revealed icon,
    &quot;state&quot;            : State, hidden, revealed, unlocked,
    &quot;totalSteps&quot;       : Total number of steps,
    &quot;type&quot;             : Incremental or standard,
    &quot;unlockedIconUrl&quot;  : URL for the unlocked icon,
    &quot;valid&quot;            : 1 or 0 if valid,
    &quot;xp&quot;               : Amount of XP awarded
}
</code></pre>

<h4 id="achievementsshowallui">Achievements:ShowAllUI</h4>
<pre><code>{
    &quot;result&quot; : result code
}
</code></pre>

<h4 id="achievementsfetchall">Achievements:FetchAll</h4>
<pre><code>    &quot;result&quot;            : result code,
    &quot;achievement_array&quot; : array of Achievements
</code></pre>

<h4 id="achievementsfetch">Achievements:Fetch</h4>
<pre><code>    &quot;result&quot;         : result code,
    &quot;achievement&quot; : Achievement
</code></pre>

<h3 id="multiplayer">Multiplayer</h3>
<h4 id="player">Player</h4>
<pre><code>{
    &quot;valid&quot;,
    &quot;id&quot;,
    &quot;name&quot;,
    &quot;avatarUrlHiRes&quot;,
    &quot;avatarUrlIconRes&quot;,
    &quot;hasLevelInfo&quot;,
    &quot;currentLevel&quot;,
    &quot;nextLevel&quot;,
    &quot;currentXP&quot;,
    &quot;lastLevelUpTime&quot;,
    &quot;title&quot;,
}
</code></pre>

<h4 id="playerlevel">PlayerLevel</h4>
<pre><code>{
    &quot;valid&quot;,
    &quot;levelNumber&quot;,
    &quot;minimumXP&quot;,
    &quot;maximumXP&quot;
}
</code></pre>

<h4 id="participant">Participant</h4>
<pre><code>{
    &quot;valid&quot;,
    &quot;displayName&quot;,
    &quot;avatarUrl&quot;,
    &quot;id&quot;,
    &quot;hasPlayer&quot;,
    &quot;player&quot;,
    &quot;participantStatus&quot;,
    &quot;hasMatchResult&quot;,
    &quot;matchResult&quot;,
    &quot;matchRank&quot;,
    &quot;icConnectedToRoom&quot;
}
</code></pre>

<h4 id="room">Room</h4>
<pre><code>{
    &quot;valid&quot;,
    &quot;id&quot;,
    &quot;variant&quot;,
    &quot;automatchWaitEstimate&quot;,
    &quot;creatingParticipant&quot;,
    &quot;creationTime&quot;,
    &quot;description&quot;,
    &quot;participants&quot;,
    &quot;remainingAutomatchingSlots&quot;,
    &quot;status&quot;
}
</code></pre>

<h4 id="multiplayerinvitation">MultiplayerInvitation</h4>
<pre><code>{
    &quot;valid&quot;,
    &quot;id&quot;,
    &quot;variant&quot;,
    &quot;automatchingSlotsAvailable&quot;,
    &quot;creationTime&quot;,
    &quot;invitingParticipant&quot;,
    &quot;type&quot;,
    &quot;participants&quot;
}
</code></pre>

<h4 id="participantresults">ParticipantResults</h4>
<pre><code>{
    &quot;valid&quot;,
    &quot;hasResultsForParticipant&quot;,
    &quot;placeForParticipant&quot;,
    &quot;matchResultForParticipant&quot;
}
</code></pre>

<h4 id="turnbasedmatch">TurnBasedMatch</h4>
<pre><code>{
    &quot;valid&quot;,
    &quot;id&quot;,
    &quot;creationTime&quot;,
    &quot;lastUpdateTime&quot;,
    &quot;creatingParticipant&quot;,
    &quot;lastUpdatingParticipant&quot;,
    &quot;pendingParticipant&quot;,
    &quot;matchStatus&quot;,
    &quot;automatchingSlotsAvailable&quot;,
    &quot;variant&quot;,
    &quot;description&quot;,
    &quot;number&quot;,
    &quot;version&quot;
}
</code></pre>

<h3 id="nearbyconnections_1">NearbyConnections</h3>
<h4 id="nearbyconnectionsinit">NearbyConnections:Init</h4>
<pre><code>{
    &quot;InitializationStatus&quot; : initialization result
}
</code></pre>

<h4 id="nearbyconnectionsstartadvertising">NearbyConnections:StartAdvertising</h4>
<pre><code>{
    &quot;client_id&quot; : client id,
    &quot;start_advertising_result&quot; :
    {
        &quot;status&quot;    : start advertising result,
        &quot;local_endpoint_name&quot;   : local endpoint name
    }
},
{
    &quot;client_id&quot; : client id,
    &quot;request&quot; :
    {
        &quot;remote_endpoint_id&quot; : remote endpoint id,
        &quot;remote_device_id&quot; : remote device id
        &quot;remote_endpoint_name&quot;: remote endpoint name
        &quot;payload&quot; : payload message
    }
}
</code></pre>

<h4 id="nearbyconnectionsacceptconnectionrequest">NearbyConnections:AcceptConnectionRequest</h4>
<pre><code>{
    &quot;event&quot; : &quot;OnMessageReceived&quot; or &quot;OnDisconnected&quot;,
    &quot;client_id&quot; : client id,
    &quot;remote_endpoint_id&quot; : remote endpoint id,
    &quot;payload&quot; : payload message, valid when event is &quot;OnMessageReceived&quot;,
    &quot;is_reliable&quot; : if message is reliable, valid when event is &quot;OnMessageReceived&quot;
}
</code></pre>

<h4 id="nearbyconnectionsstartdiscovery">NearbyConnections:StartDiscovery</h4>
<pre><code>{
    &quot;event&quot; : &quot;OnEndpointFound&quot; or &quot;&quot;,
    &quot;client_id&quot; : client id,
    &quot;remote_endpoint_id&quot;, remote endpoint id, valid when event is &quot;OnEndpointLost&quot;
    &quot;endpoint_details&quot; : endpoint info, valid when event is &quot;OnEndpointFound&quot;
    {
        &quot;endpoint_id&quot; : endpoint id,
        &quot;device_id&quot; : device id,
        &quot;name&quot; : name,
        &quot;service_id&quot; : service id
    }
}
</code></pre>

<h4 id="nearbyconnectionssendconnectionrequest">NearbyConnections:SendConnectionRequest</h4>
<p>second callback function result is same with NearbyConnections:AcceptConnectionRequest</p>
<pre><code>{
    &quot;client_id&quot; : client id,
    &quot;response&quot; : connection response
    {
        &quot;remote_endpoint_id&quot; : remote endpoint id,
        &quot;status&quot; : status code;
        &quot;payload&quot; : payload message;
    }
},
{
    &quot;event&quot; : &quot;OnMessageReceived&quot; or &quot;OnDisconnected&quot;,
    &quot;client_id&quot; : client id,
    &quot;remote_endpoint_id&quot; : remote endpoint id,
    &quot;payload&quot; : payload message, valid when event is &quot;OnMessageReceived&quot;,
    &quot;is_reliable&quot; : if message is reliable, valid when event is &quot;OnMessageReceived&quot;
}
</code></pre>

<h2 id="manual-integration">Manual Integration</h2>
<p>If the <em>SDKBOX Installer</em> <strong>fails</strong> to complete successfully, it is possible to integrate SDKBOX manually. If the installer complete successfully, please <strong>do not</strong> complete anymore of this document. It is not necessary.</p>
<p>These steps are listed last in this document on purpose as they are seldom needed. If you find yourself using these steps, please, after completing, double back and re-read the steps above for other integration items.</p>
<h2 id="manual-integration-for-ios">Manual Integration For iOS</h2>
<p>Drag and drop the following frameworks from the <strong>plugins/ios</strong> folder of
the<code>GooglePlay</code> bundle into your Xcode project, check <code>Copy items if needed</code> when adding frameworks:</p>
<blockquote>
<p>sdkbox.framework</p>
<p>PluginGPG.framework</p>
<p>GoogleAppUtilities.framework</p>
<p>GoogleAuthUtilities.framework</p>
<p>GoogleNetworkingUtilities.framework</p>
<p>GoogleOpenSource.framework</p>
<p>GooglePlus.bundle</p>
<p>GooglePlus.framework</p>
<p>GoogleSignIn.bundle</p>
<p>GoogleSignIn.framework</p>
<p>GoogleSymbolUtilities.framework</p>
<p>GoogleUtilities.framework</p>
<p>gpg.bundle</p>
<p>gpg.framework</p>
</blockquote>
<p>The above frameworks depend upon other frameworks. You also need to add the
following system frameworks, if you don't already have them:</p>
<blockquote>
<p>AddressBook.framework</p>
<p>AssetsLibrary.framework</p>
<p>CoreData.framework</p>
<p>CoreLocation.framework</p>
<p>CoreMotion.framework</p>
<p>CoreTelephony.framework</p>
<p>CoreText.framework</p>
<p>Foundation.framework</p>
<p>MediaPlayer.framework</p>
<p>QuartzCore.framework</p>
<p>SafariServices</p>
<p>Security.framework</p>
<p>StoreKit</p>
<p>Security.framework</p>
<p>SystemConfiguration.framework</p>
<p>libc++.dylib</p>
<p>libz.dylib</p>
</blockquote>
<p>Add a linker flag, if your setup requires it, to:
<strong>Target -&gt; Build Settings -&gt; Linking -&gt; Other Linker Flags</strong>:</p>
<blockquote>
<p>-ObjC</p>
</blockquote>
<h3 id="code-changes">Code changes</h3>
<h4 id="set-a-rootview-controller-for-gpg_1">Set a rootview controller for GPG:</h4>
<p>Update <code>proj.ios_mac/ios/RootViewController.h</code>
Add this:</p>
<pre><code>#import &lt;GoogleSignIn/GoogleSignIn.h&gt;

// Change RootViewController class definition to:
@interface RootViewController : UIViewController&lt;GIDSignInUIDelegate&gt;
</code></pre>

<h4 id="set-google-play-signin-listeners_1">Set Google Play signin listeners</h4>
<p>Update <code>proj.ios_mac/ios/AppController.mm</code></p>
<ol>
<li>Add this method:</li>
</ol>
<pre><code>- (BOOL)application:(UIApplication *)app openURL:(NSURL *)url options:(NSDictionary *)options {
    return [[GIDSignIn sharedInstance] handleURL:url
                               sourceApplication:options[UIApplicationOpenURLOptionsSourceApplicationKey]
                                      annotation:options[UIApplicationOpenURLOptionsAnnotationKey]];
}
</code></pre>

<ol>
<li>In this method:</li>
</ol>
<pre><code>(BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
</code></pre>

<p>add a call to (before return YES):</p>
<pre><code>    // _viewController could also be named
    //  viewController, depending of the project type.
    [GIDSignIn sharedInstance].uiDelegate = _viewController;
</code></pre>

<h4 id="add-url-types_1">Add URL types</h4>
<p>Add the following URL types under <strong>your project &gt; Info &gt; URL Types</strong></p>
<ul>
<li>
<p>URL 1:</p>
<ul>
<li>Identifier: <code>com.google.ReverseClientId</code></li>
<li>Url schemes: <code>com.googleusercontent.apps.777734739048-cdkbeieil19d6pfkavddrri5o19gk4ni</code><blockquote>
<p>(use this as sample, or put your very own application's url scheme)</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>URL 2:</p>
<ul>
<li>Identifier: <code>com.google.BundleId</code></li>
<li>URL schemes: <code>com.sdkbox.gpg</code><blockquote>
<p>(use this as sample or put your own application's bundle id)</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h4 id="further-info_1">Further info</h4>
<p>For more information check out the <a href="https://developers.google.com/games/services/cpp/gettingStartedIOS">official documentation</a></p>
<h2 id="manual-integration-for-android">Manual Integration For Android</h2>
<p>SDKBOX supports three different kinds of <strong>Android</strong> projects <strong>command-line</strong>, <strong>eclipse</strong> and <strong>Android Studio</strong>. </p>
<ul>
<li><code>proj.android</code> will be used as our <code>&lt;project_root&gt;</code> for <strong>command-line</strong> and <strong>eclipse</strong> project</li>
<li><code>proj.android-studio</code> will be used as our <code>&lt;project_root&gt;</code> for <strong>Android Studio</strong> project.</li>
</ul>
<h3 id="copy-files">Copy Files</h3>
<p>Copy the following <strong>jar</strong> files from <code>plugin/android/libs</code> folder of this
bundle into your project's <strong><project_root>/libs</strong> folder.</p>
<blockquote>
<p>Plugingpg.jar</p>
<p>sdkbox.jar</p>
</blockquote>
<ul>
<li>
<p>If you're using cocos2d-x from source copy the <strong>jar</strong> files to:</p>
<p>Android command-line:
<code>cocos2d/cocos/platform/android/java/libs</code></p>
<p>Android Studio:
<code>cocos2d/cocos/platform/android/libcocos2dx/libs</code></p>
</li>
<li>
<p>If you're using cocos2d-js or lua copy the <strong>jar</strong> files to:</p>
<p>Android command-line:
<code>frameworks/cocos2d-x/cocos/platform/android/java/libs</code></p>
<p>Android Studio:
<code>frameworks/cocos2d-x/cocos/platform/android/libcocos2dx/libs</code></p>
</li>
<li>
<p>If you're using prebuilt cocos2d-x copy the <strong>jar</strong> files to:</p>
<p>Android command-line:
<code>&lt;project_root&gt;/libs</code></p>
</li>
</ul>
<h4 id="copy-jni-libs">Copy jni libs</h4>
<p>Copy and overwrite all the folders from <code>plugin/android/jni</code>
to your <code>&lt;project_root&gt;/jni/</code> directory.</p>
<h3 id="edit-androidmanifestxml">Edit <code>AndroidManifest.xml</code></h3>
<p>Add following meta-data tags:</p>
<pre><code class="xml">&lt;meta-data android:name=&quot;com.google.android.gms.version&quot;
    android:value=&quot;@integer/google_play_services_version&quot; /&gt;
&lt;meta-data android:name=&quot;com.google.android.gms.games.APP_ID&quot;
    android:value=&quot;@string/google_app_id&quot; /&gt;
</code></pre>

<p>Make sure to add an entry to the file <code>res/values/string.xml</code> of the form: <code>&lt;string name="google_app_id"&gt;777734739048&lt;/string&gt;</code>
Change that value for your own generated play games App Id.</p>
<h3 id="edit-androidmk">Edit <code>Android.mk</code></h3>
<p>Edit <code>&lt;project_root&gt;/jni/Android.mk</code> to:</p>
<p>Install in a folder named <code>gpg</code> inside your <code>proj.android\jni</code> directory</p>
<p>Add this to your <code>android.mk</code> file</p>
<h4 id="add-include-path">Add include path</h4>
<pre><code>LOCAL_C_INCLUDES += ./gpg/include/
</code></pre>

<h4 id="add-static-libraries">Add static libraries</h4>
<p>Add additional requirements to <strong>LOCAL_WHOLE_STATIC_LIBRARIES</strong>:</p>
<pre><code>LOCAL_WHOLE_STATIC_LIBRARIES += gpg-1
LOCAL_WHOLE_STATIC_LIBRARIES += PluginGPG
LOCAL_WHOLE_STATIC_LIBRARIES += sdkbox
</code></pre>

<p>Add a call to:</p>
<pre><code>$(call import-add-path,$(LOCAL_PATH))
</code></pre>

<p>before any <strong>import-module</strong> statements.</p>
<p>Add additional <strong>import-module</strong> statements at the end:</p>
<pre><code>$(call import-module, ./gpg)
$(call import-module, ./sdkbox)
$(call import-module, ./plugingpg)
</code></pre>

<p><strong>Note:</strong> It is important to make sure these statements are above the existing <code>$(call import-module,./prebuilt-mk)</code> statement, if you are using the pre-built libraries.</p>
<h3 id="modify-applicationmk-cocos2d-x-v30-to-v32-only">Modify <code>Application.mk</code> (Cocos2d-x v3.0 to v3.2 only)</h3>
<p>Edit <code>&lt;project_root&gt;/jni/Application.mk</code> to make sure <strong>APP_STL</strong> is defined
correctly. If <code>Application.mk</code> contains <code>APP_STL := c++_static</code>, it should be
changed to:</p>
<pre><code>APP_STL := gnustl_static
</code></pre>

<h3 id="modify-cocos2dxactivityjava">Modify <strong>Cocos2dxActivity.java</strong></h3>
<ul>
<li>
<p>If you're using cocos2d-x from source, assuming you are in the <strong>proj.android</strong> directory, <strong>Cocos2dxActivity.java</strong> is located:</p>
<p><code>../../cocos2d-x/cocos/platform/android/java/src/org/cocos2dx/
lib/Cocos2dxActivity.java</code></p>
</li>
<li>
<p>If you're using the prebuilt cocos2d-x libraries assuming you are in the <code>proj.android</code> directory, <strong>Cocos2dxActivity.java</strong> is located:</p>
<p><code>./src/org/cocos2dx/lib/Cocos2dxActivity.java</code></p>
</li>
</ul>
<p><strong>Note:</strong> When using Cocos2d-x from source, different versions have <strong>Cocos2dxActivity.java</strong> in a different location. One way to find the location is to look in <strong>proj.android/project.properties</strong>. Example:
  <code>android.library.reference.1=../../cocos2d-x/cocos/platform/android/java</code></p>
<p>In this case, <strong>Cocos2dxActivity.java</strong> should be located at:</p>
<pre><code>../../cocos2d-x/cocos/platform/android/java/src/org/cocos2dx/lib/Cocos2dxActivity.java
</code></pre>

<ul>
<li>Modify <strong>Cocos2dxActivity.java</strong> to add the following imports:</li>
</ul>
<pre><code class="java">import android.content.Intent;
import com.sdkbox.plugin.SDKBox;
</code></pre>

<ul>
<li>Second, modify <strong>Cocos2dxActivity.java</strong> to edit the <code>onCreate(final Bundle savedInstanceState)</code> function to add a call to <code>SDKBox.init(this);</code>. The placement of this call is important. It must be done after the call to <code>onLoadNativeLibraries();</code>. Example:</li>
</ul>
<pre><code class="java">onLoadNativeLibraries();
SDKBox.init(this);
</code></pre>

<ul>
<li>
<p>Last, we need to insert the proper <strong>overrides</strong> code. There are a few rules here.</p>
<ul>
<li>
<p>If the method listed has not been defined, <strong>add it</strong>.</p>
</li>
<li>
<p>If the method listed has been defined, add the calls to <code>SDKBox</code> in the <strong>same</strong> existing function.</p>
</li>
</ul>
</li>
</ul>
<pre><code class="java">    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
          if(!SDKBox.onActivityResult(requestCode, resultCode, data)) {
            super.onActivityResult(requestCode, resultCode, data);
          }
    }
    @Override
    protected void onStart() {
          super.onStart();
          SDKBox.onStart();
    }
    @Override
    protected void onStop() {
          super.onStop();
          SDKBox.onStop();
    }
    @Override
    protected void onResume() {
          super.onResume();
          SDKBox.onResume();
    }
    @Override
    protected void onPause() {
          super.onPause();
          SDKBox.onPause();
    }
    @Override
    public void onBackPressed() {
          if(!SDKBox.onBackPressed()) {
            super.onBackPressed();
          }
    }
</code></pre>

<h2 id="manual-integration-for-google-play-services-sdk-dependent-library-only">Manual Integration for Google Play Services SDK (dependent library only)</h2>
<h3 id="suggestion">Suggestion</h3>
<p>Please try the SDKBOX installer first. It will do all the following step for you automatically.</p>
<pre><code class="bash">$ sdkbox import googleplayservices
</code></pre>

<h3 id="modify-projectproperties">Modify <code>project.properties</code></h3>
<p>An <strong>Android Library Reference</strong> for <strong>Google Play Services</strong> is required. The
path will be different depending upon your setup. Also, this is an additional
download that does not come as part of a standard install. To install use the
<strong>sdk installer</strong> and choose <strong>extras-&gt;google play services</strong>. Here is an example of what this line could look like:</p>
<pre><code>android.library.reference.1=
../android/sdk.latest/extras/google/google_play_services/libproject/
google-play-services_lib
</code></pre>

<p><strong>Note:</strong> if you already have an <code>android.library.reference.1</code> you can add
another by incrementing the number as <code>android.library.reference.2</code>, etc.</p>
<h3 id="integration-manually">Integration manually</h3>
<p>We make a lite version of Google Play Services, the project repo is <a href="https://github.com/darkdukey/Google-Play-Service-Lite">https://github.com/darkdukey/Google-Play-Service-Lite</a></p>
<h4 id="copy-files_1">Copy Files</h4>
<p>Copy the <code>gps</code> folder from <code>plugin</code> folder of this bundle into your project's <strong><project_root>/libs</strong> folder.</p>
<ul>
<li>
<p>If you're using cocos2d-x from source copy the <code>gps</code> folder to:</p>
<p>Android command-line:
<code>cocos2d/cocos/platform/android/java/libs</code></p>
<p>Android Studio:
<code>cocos2d/cocos/platform/android/libcocos2dx/libs</code></p>
</li>
<li>
<p>If you're using cocos2d-js or lua copy the <code>gps</code> folder to:</p>
<p>Android command-line:
<code>frameworks/cocos2d-x/cocos/platform/android/java/libs</code></p>
<p>Android Studio:
<code>frameworks/cocos2d-x/cocos/platform/android/libcocos2dx/libs</code></p>
</li>
<li>
<p>If you're using prebuilt cocos2d-x copy the <code>gps</code> folder to:</p>
<p>Android command-line:
<code>&lt;project_root&gt;/libs</code></p>
</li>
</ul>
<h4 id="modify-files-for-eclipse">Modify files for Eclipse</h4>
<ol>
<li>Modify project.properties</li>
</ol>
<pre><code># For source project
android.library.reference.2=../cocos2d/cocos/platform/android/java/libs/gps/

# Or
# For framework project
android.library.reference.1=libs/gps/
</code></pre>

<h4 id="modify-files-for-android-studio">Modify files for Android Studio</h4>
<h5 id="1-modify-cocos2dcocosplatformandroidlibcocos2dxbuildgradle">1. Modify cocos2d/cocos/platform/android/libcocos2dx/build.gradle</h5>
<pre><code> dependencies {
+    compile project(':gps')
     compile fileTree(dir: '../java/libs', include: ['*.jar'])
 }
</code></pre>

<h5 id="2-modify-projandroid-studioappprojectproperties">2. Modify proj.android-studio/app/project.properties</h5>
<pre><code> # Project target.
 target=android-14
+android.library.reference.1=../cocos2d/cocos/platform/android/java/libs/gps/
</code></pre>

<h5 id="3-modify-projandroid-studiosettingsgradle">3. Modify proj.android-studio/settings.gradle</h5>
<pre><code> project(':libcocos2dx').projectDir = new File(settingsDir, '../cocos2d/cocos/platform/android/libcocos2dx')
 include ':your_project_name'
 project(':your_project_name').projectDir = new File(settingsDir, 'app')
+
+include ':gps'
+project(':gps').projectDir = new File(settingsDir, '../cocos2d/cocos/platform/android/java/libs/gps')
</code></pre>

<h2 id="proguard-optional">Proguard (optional)</h2>
<ul>
<li>Edit <code>project.properties</code>  to specify a <code>Proguard</code> configuration file. Example:</li>
</ul>
<pre><code>proguard.config=${sdk.dir}/tools/proguard/proguard-android.txt:proguard-project.txt
</code></pre>

<ul>
<li>Edit the file you specified to include the following:</li>
</ul>
<pre><code># cocos2d-x
-keep public class org.cocos2dx.** { *; }
-dontwarn org.cocos2dx.**
-keep public class com.chukong.** { *; }
-dontwarn com.chukong.**

# google play service
-keep class com.google.android.gms.** { *; }
-dontwarn com.google.android.gms.**

-keep class * extends java.util.ListResourceBundle {
    protected Object[][] getContents();
}

-keep public class com.google.android.gms.common.internal.safeparcel.SafeParcelable {
    public static final *** NULL;
}

-keepnames @com.google.android.gms.common.annotation.KeepName class *
-keepclassmembernames class * {
    @com.google.android.gms.common.annotation.KeepName *;
}

-keepnames class * implements android.os.Parcelable {
    public static final ** CREATOR;
}

#sdkbox
-keep class com.sdkbox.** { *; }
-dontwarn com.sdkbox.**
</code></pre>

<p><strong>Note:</strong> Proguard only works with <strong>Release</strong> builds (i.e <code>cocos run -m release</code>) debug builds do not invoke Proguard rules.</p></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Build Date UTC :2021-11-25 02:49:55.420666, Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        
        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script>var base_url = '../../..';</script>
        <script src="../../../js/base.js"></script>
        


        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-70044300-2', 'auto');
            ga('send', 'pageview');
        </script>
        
    </body>
</html>
